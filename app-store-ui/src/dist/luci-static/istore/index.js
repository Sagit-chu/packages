var xe=Object.defineProperty,Ce=Object.defineProperties;var Se=Object.getOwnPropertyDescriptors;var ge=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var fe=(t,e,n)=>e in t?xe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Z=(t,e)=>{for(var n in e||(e={}))Le.call(e,n)&&fe(t,n,e[n]);if(ge)for(var n of ge(e))Ae.call(e,n)&&fe(t,n,e[n]);return t},de=(t,e)=>Ce(t,Se(e));var Te=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var L=(t,e,n)=>new Promise((a,o)=>{var u=l=>{try{c(n.next(l))}catch(h){o(h)}},i=l=>{try{c(n.throw(l))}catch(h){o(h)}},c=l=>l.done?a(l.value):Promise.resolve(l.value).then(u,i);c((n=n.apply(t,e)).next())});import{a as pe,c as Ee,u as R,b as K,d as B,r as se,o as d,e as _,F as O,f as W,g as X,w as Ie,h as r,p as re,i as le,j as s,t as g,k as z,n as j,l as De,m as A,q as we,s as Pe,v as N,x as _e,y as be,z as ie,A as $e,B as ye,C as Be,D as ve,E as Ve,G as Fe,H as Me}from"./vendor.js?v=64c6a109";var Zo=Te(I=>{const ze=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const i of u.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function a(o){if(o.ep)return;o.ep=!0;const u=n(o);fetch(o.href,u)}};ze();const Ue=t=>L(I,null,function*(){const e=window.vue_lang;new Date().getTime();let n={};try{const o=yield pe({url:window.vue_lang_data,method:"GET"});o.data&&(n=o.data)}catch(o){console.log(o)}const a=Ee({defaultLanguage:e,translations:n,setGlobalProperties:!1,provideDirective:!1,provideComponent:!1});t.use(a)});var E=(t,e)=>{const n=t.__vccOpts||t;for(const[a,o]of e)n[a]=o;return n};const Oe=t=>(re("data-v-13251538"),t=t(),le(),t),Re={class:"tabs"},Ge=["href","onClick"],Ne={key:0},He=Oe(()=>s("div",{class:"auto"},null,-1)),Ke={setup(t){const{$gettext:e}=R(),n=K(),a=B(()=>n.state.version),o=B(()=>[{to:"/installed",name:e("installed")},{to:"/store",name:e("all app")},{to:"/upload",name:e("manual install")},{to:"/maintance",name:e("maintain"),up:a.value}]);return(u,i)=>{const c=se("router-link");return d(),_("ul",Re,[(d(!0),_(O,null,W(r(o),l=>(d(),X(c,{to:l.to,custom:"",key:l.to},{default:Ie(({href:h,navigate:y,isActive:k})=>[s("li",{class:j(k&&"active cbi-tab")},[s("a",{href:h,onClick:y},g(l.name),9,Ge),l.up?(d(),_("span",Ne)):z("",!0)],2)]),_:2},1032,["to"]))),128)),He])}}};var We=E(Ke,[["__scopeId","data-v-13251538"]]);const qe=()=>window.vue_base,Ze=()=>window.istore_api_base||"https://istore.linkease.com",Ye=t=>{if(t)return De(t).format("YYYY-MM-DD HH:mm:ss")},Je=()=>new Date().getTime(),Qe=t=>{if(t<1024)return""+t+"KB";let n=1024,a=0;for(let u=t/1024;u>=1024;u/=1024)n*=1024,a++;let o=["M","G","T","P","E"];return(t/100/(n/100)).toFixed(2)+o[a]},Xe=t=>{if(t==null)return 0;if(t<1e4)return t;let n=parseInt(`${t/1e4}`),a=t%1e4;return`${n}\u4E07${a}`},je=()=>window.token||"",et=()=>{var t;return((t=window==null?void 0:window.device_id)==null?void 0:t.uid)||""},tt=()=>{var t;return((t=window==null?void 0:window.device_id)==null?void 0:t.version)||""},nt=()=>{var t;return((t=window==null?void 0:window.device_id)==null?void 0:t.arch)||""},at=()=>"https://www.kooldns.cn/bind",me={all:"\u5168\u90E8",sys:"\u7CFB\u7EDF",tool:"\u5DE5\u5177",net:"\u7F51\u7EDC"},ot=t=>me[t]?me[t]:t;var st=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",BasePage:qe,ApiBaseURL:Ze,formatDate:Ye,UnixDate:Je,numberToSize:Qe,numberToSum:Xe,getToken:je,getDeviceId:et,getVersion:tt,modelArch:nt,getIframeURL:at,getTagValue:ot}),U=Z({},st);const D=pe.create({});D.interceptors.request.use(t=>(t.params==null&&(t.params={}),t.params=de(Z({},t.params),{token:U.getToken(),_t:U.UnixDate()}),t),t=>t);D.interceptors.response.use(t=>t,t=>t);const Y=pe.create({baseURL:U.ApiBaseURL()});Y.interceptors.request.use(t=>(t.params==null&&(t.params={}),t.params=de(Z({},t.params),{modelArch:U.modelArch(),deviceId:U.getDeviceId(),_t:U.UnixDate()}),t),t=>t);Y.interceptors.response.use(t=>t);const rt=()=>new Promise((t,e)=>L(I,null,function*(){try{const n=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/installed"});if(n.status==200){t(n.data);return}e(n.status);return}catch(n){e(n);return}})),lt=t=>new Promise((e,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/install",params:{package:t}});if(a.status==200){e(a.data);return}n(a.status);return}catch(a){n(a);return}})),ct=t=>new Promise((e,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/upgrade",params:{package:t}});if(a.status==200){e(a.data);return}n(a.status);return}catch(a){n(a);return}})),it=t=>new Promise((e,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/remove",params:{package:t}});if(a.status==200){e(a.data);return}n(a.status);return}catch(a){n(a);return}})),ut=()=>new Promise((t,e)=>L(I,null,function*(){try{const n=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/update"});if(n.status==200){t(n.data);return}e(n.status);return}catch(n){e(n);return}})),dt=t=>new Promise((e,n)=>L(I,null,function*(){try{const a=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/status",params:{package:t}});if(a.status==200){e(a.data);return}n(a.status);return}catch(a){n(a);return}})),pt=()=>new Promise((t,e)=>L(I,null,function*(){try{const n=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/log"});if(n.status==200){t(n.data);return}e(n.status);return}catch(n){e(n);return}})),_t=t=>new Promise((e,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/upload",headers:{"Content-Type":"multipart/form-data"},data:t});if(a.data){e(a.data);return}}catch(a){n(a);return}n("not found soft")})),ht=()=>new Promise((t,e)=>L(I,null,function*(){try{const n=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/light_backup"});if(n.status==200){t(n.data);return}e(n.status);return}catch(n){e(n);return}})),gt=t=>new Promise((e,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/light_restore",headers:{"Content-Type":"multipart/form-data"},data:t});if(a.data){e(a.data);return}}catch(a){n(a);return}n("not found soft")})),ft=t=>new Promise((e,n)=>L(I,null,function*(){try{const a=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/get_available_backup_file_list",params:{path:t}});if(a.status==200){e(a==null?void 0:a.data);return}n(a.status);return}catch(a){n(a);return}})),vt=()=>new Promise((t,e)=>L(I,null,function*(){try{const n=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/get_local_backup_dir_path"});if(n.status==200){t(n==null?void 0:n.data);return}e(n.status);return}catch(n){e(n);return}})),mt=(t,e)=>new Promise((n,a)=>L(I,null,function*(){try{const o=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/local_backup",params:{path:t,force:e}});if(o.status==200){n(o==null?void 0:o.data);return}a(o.status);return}catch(o){a(o);return}})),wt=t=>new Promise((e,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/local_restore",params:{path:t}});if(a.status==200){e(a.data);return}n(a.status);return}catch(a){n(a);return}})),bt=()=>new Promise((t,e)=>L(I,null,function*(){try{const n=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/get_block_devices"});if(n.status==200){t(n==null?void 0:n.data);return}e(n.status);return}catch(n){e(n);return}}));var $t=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getInstalledApp:rt,installApp:lt,upgradeApp:ct,removeApp:it,updateAppStore:ut,getAppStatus:dt,getLog:pt,uploadAppIPK:_t,lightBackup:ht,lightRestore:gt,backupFileList:ft,localBackupdirPath:vt,localBackup:mt,localRestore:wt,getBlockDevices:bt});const yt=t=>new Promise((e,n)=>L(I,null,function*(){var a,o,u,i;try{const c=yield Y({method:"GET",url:"/api/store/list",params:t});if(((a=c==null?void 0:c.data)==null?void 0:a.success)===0){e((o=c==null?void 0:c.data)==null?void 0:o.result);return}if((u=c==null?void 0:c.data)!=null&&u.message){n((i=c==null?void 0:c.data)==null?void 0:i.message);return}n("error")}catch(c){console.log(c),n(c);return}})),kt=U.ApiBaseURL(),xt=t=>`${kt}${t}`,Ct=()=>new Promise((t,e)=>L(I,null,function*(){var n,a,o,u;try{const i=yield Y({method:"GET",url:"/api/store/tags"});if(((n=i==null?void 0:i.data)==null?void 0:n.success)===0){t((a=i==null?void 0:i.data)==null?void 0:a.result);return}if((o=i==null?void 0:i.data)!=null&&o.message){e((u=i==null?void 0:i.data)==null?void 0:u.message);return}e("error")}catch(i){e(i);return}})),St=t=>new Promise((e,n)=>{Y({method:"POST",url:"/api/store/expand",data:{appsId:t||[],deviceId:U.getDeviceId()}}).then(a=>{var o,u,i;if(((o=a.data)==null?void 0:o.success)==0&&((u=a.data)==null?void 0:u.result)){e((i=a.data)==null?void 0:i.result);return}n("not found expand")}).catch(a=>{n(a)})}),Lt=t=>{Y({method:"POST",url:"/api/store/download",data:{appId:t,deviceId:U.getDeviceId()}}).then(e=>{var n;((n=e.data)==null?void 0:n.success)!=0})},At=t=>new Promise((e,n)=>{Y({method:"POST",url:"/api/store/star",data:{appId:t,deviceId:U.getDeviceId()}}).then(a=>{var o;if(((o=a.data)==null?void 0:o.success)==0){e(a.data);return}n("not found expand")}).catch(a=>{n(a)})});var Tt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getStoreAppList:yt,getStoreAppIcon:xt,getStoreTags:Ct,getAppExpandData:St,increasingDownloadCount:Lt,postStarApp:At});const Et=()=>D({method:"GET",url:"/cgi-bin/luci/admin/store/check_self_upgrade"}),It=()=>D({method:"POST",url:"/cgi-bin/luci/admin/store/do_self_upgrade"});var Dt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",updateIstore:Et,selfUpdateIstore:It}),T=Z(Z(Z({},$t),Tt),Dt);const Pt={setup(){const t=K(),e=B(()=>t.state.log.action),n=B(()=>t.state.log.content),a=B(()=>t.state.log.end),o=B(()=>t.state.log.exitCode),u=A(!1),i=A(null);let c="",l=A(""),h=A("."),y="",k="";switch(e.value){case"install":c="\u6B63\u5728\u5B89\u88C5\u63D2\u4EF6",y="\u5B89\u88C5\u5B8C\u6210,\u8BF7\u5173\u95ED\u5F53\u524D\u7A97\u53E3",k="\u5B89\u88C5\u5931\u8D25,\u9519\u8BEF\u7801";break;case"uninstall":c="\u6B63\u5728\u5378\u8F7D\u63D2\u4EF6",y="\u5378\u8F7D\u6210\u529F,\u8BF7\u5173\u95ED\u5F53\u524D\u7A97\u53E3",k="\u5378\u8F7D\u5931\u8D25,\u9519\u8BEF\u7801";break;case"upgrade":c="\u6B63\u5728\u66F4\u65B0\u63D2\u4EF6",y="\u66F4\u65B0\u6210\u529F,\u8BF7\u5173\u95ED\u5F53\u524D\u7A97\u53E3",k="\u66F4\u65B0\u5931\u8D25,\u9519\u8BEF\u7801";break;case"upload":c="\u6B63\u5728\u4E0A\u4F20\u63D2\u4EF6",y="\u79BB\u7EBF\u5B89\u88C5\u6210\u529F,\u8BF7\u5173\u95ED\u5F53\u524D\u7A97\u53E3",k="\u79BB\u7EBF\u5B89\u88C5\u5931\u8D25,\u9519\u8BEF\u7801";break}we(()=>{document.body.setAttribute("lock-scroll",!0),V()}),Pe(()=>{document.body.removeAttribute("lock-scroll")});const P=()=>{var f;(f=i.value)!=null&&f.scrollHeight&&(i.value.scrollTop=i.value.scrollHeight)},V=()=>{setTimeout(()=>{if(a.value){w(),P();return}T.getLog().then(f=>{if(a.value){w(),P();return}switch(f==null?void 0:f.code){}const C=f==null?void 0:f.stdout,v=f==null?void 0:f.stderr;(C||v)&&(l.value=`${C}${v}`),h.value=`${h.value}.`,P(),V()}).catch(f=>{l.value=`${f}`,P(),V()})},500)},w=()=>{u.value=!0},p=()=>{location.reload()};return{logText:B(()=>u.value?o.value!==void 0&&o.value!==0?`${c}
${n.value}
${k} ${o.value}
`:`${c}
${n.value}
${y}
`:`${c}
${h.value}
${l.value}
${n.value}
`),Close:p,disabled:u,textDom:i}},mounted(){this.$nextTick(()=>{const t=document.querySelector("body");t.append?t.append(this.$el):t.appendChild(this.$el)})}},he=t=>(re("data-v-6695545b"),t=t(),le(),t),Bt={class:"software-log_shade"},Vt=he(()=>s("div",{class:"software-log_shade__bg"},null,-1)),Ft={class:"software-log_shade__pannel"},Mt=he(()=>s("div",{class:"software-log_shade__pannel-title"}," \u8F6F\u4EF6\u4E2D\u5FC3 - \u65E5\u5FD7\u8BB0\u5F55 ",-1)),zt=he(()=>s("div",{class:"software-log_shade__pannel-now"},[s("i",null,"\xA0\xA0\xA0\xA0\u63D2\u4EF6\u5B89\u88C5/\u5378\u8F7D\u8FC7\u7A0B\u4E2D\u8BF7\u52FF\u5237\u65B0\u6B64\u9875\u9762\uFF01")],-1)),Ut={class:"software-log_shade__pannel-content"},Ot=["value"],Rt={key:0,class:"software-log_shade__pannel-btn"};function Gt(t,e,n,a,o,u){return d(),_("div",Bt,[Vt,s("div",Ft,[Mt,zt,s("div",Ut,[s("textarea",{ref:"textDom",cols:"63",rows:"26",wrap:"on",readonly:"readonly",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",value:a.logText},null,8,Ot)]),a.disabled?(d(),_("div",Rt,[s("button",{class:"close",onClick:e[0]||(e[0]=i=>a.Close())}," \u5173\u95ED ")])):z("",!0)])])}var Nt=E(Pt,[["render",Gt],["__scopeId","data-v-6695545b"]]);const Ht={setup(t){const e=K();e.dispatch("getData");const n=B(()=>e.state.log.status);return(a,o)=>{const u=se("router-view");return d(),_(O,null,[N(We),N(u),r(n)?(d(),X(Nt,{key:0})):z("",!0)],64)}}},Kt={class:"toast"},Wt=["title"],qt={key:1,class:"msg"},Zt=["innerHTML"],Yt={props:{content:String,type:String,Close:Function,keep:Boolean,html:Boolean},setup(t){const e=t,{$gettext:n}=R(),a=A(e.content),o=A(e.keep),u=A(e.html);e.keep||setTimeout(()=>{e.Close()},2e3);const i=()=>{e.Close()};return(c,l)=>(d(),_("div",Kt,[o.value?(d(),_("div",{key:0,class:"toast-close",onClick:i,title:r(n)("closed")},"x",8,Wt)):z("",!0),u.value?z("",!0):(d(),_("div",qt,g(a.value),1)),u.value?(d(),_("div",{key:2,class:"msg",innerHTML:a.value},null,8,Zt)):z("",!0)]))}};var Jt=E(Yt,[["__scopeId","data-v-6a723585"]]);const M=t=>{let e={content:"",type:"",keep:!1,html:!1,Close:()=>{a.unmount(n),document.body.removeChild(n)}};t!=null&&(typeof t=="object"?(e.content=(t==null?void 0:t.content)||"",e.type=(t==null?void 0:t.type)||"",e.keep=(t==null?void 0:t.keep)||!1,e.html=(t==null?void 0:t.html)||!1):e.content=t);let n=document.createElement("div"),a=_e(Jt,e);document.body.append(n),a.mount(n),be(()=>{a.unmount(n),document.body.removeChild(n)})},Qt={props:{content:String,Close:Function},setup(t){return{message:t.content}}},Xt=t=>(re("data-v-6d7664a4"),t=t(),le(),t),jt={class:"loading"},en=Xt(()=>s("div",{class:"icon"},null,-1)),tn={class:"msg"};function nn(t,e,n,a,o,u){return d(),_("div",jt,[en,s("div",tn,g(a.message),1)])}var an=E(Qt,[["render",nn],["__scopeId","data-v-6d7664a4"]]),H={props:{content:"",Close:()=>{}},Start(t){this.props={content:t,Close:()=>{e.unmount(n),document.body.removeChild(n)}};let e=_e(an,this.props),n=document.createElement("div");document.body.append(n),e.mount(n),be(()=>{this.props.Close()})},Stop(){this.props.Close()}};const on=()=>`
        <style>
            [lock-scroll="true"] {
                overflow: hidden !important;
            }
            .software-log_shade[data-logger],.software-log_shade[data-logger] *{-webkit-box-sizing:border-box;-webkit-tap-highlight-color:transparent;box-sizing:border-box;word-wrap:break-word;outline:none}.software-log_shade[data-logger]{width:100%;height:100%;display:flex;flex-wrap:wrap;align-items:center;justify-content:center;position:fixed;top:0;bottom:0;left:0;right:0;z-index:99999}.software-log_shade[data-logger] .software-log_shade__bg{position:fixed;top:0;bottom:0;left:0;right:0;background:rgba(68,79,83,0.94) none repeat scroll 0 0 !important;background-position:0 0;background-size:cover;opacity:0.94}.software-log_shade[data-logger] .software-log_shade__pannel{width:800px;min-width:800px;border-radius:10px;z-index:100;box-shadow:3px 3px 10px #000;background:rgba(0,0,0,0.9);padding:10px}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-title{text-align:center;font-size:18px;color:#99ff00;padding:10px;font-weight:bold}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-now i{color:#fc0;font-style:normal}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content{padding:10px;width:100%;text-align:center;overflow:hidden}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea{width:100%;border:0px solid #222;font-family:"Lucida Console";font-size:11px;background:transparent;color:#ffffff;outline:none;overflow-x:hidden;resize:none;transition:0.5s}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea:focus,.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea:hover{box-shadow:none;border-color:transparent !important}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea::-webkit-scrollbar{width:5px;height:5px}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea::-webkit-scrollbar-thumb{height:30px;outline:none;border:none;border-radius:1rem;background-color:#4c595c;-webkit-border-radius:1rem}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea::-webkit-scrollbar-track-piece{background:none;-webkit-border-radius:0;border-radius:0}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-btn{width:100%;height:50px;display:flex;flex-wrap:wrap;align-items:center;justify-content:center}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-btn button{visibility:visible;min-width:88px;font-weight:bolder;text-shadow:1px 1px 0px black;border-radius:8px;height:33px;font-family:Verdana, Microsoft Yahei UI, sans-serif;font-size:12px;padding:0 0.7em 0 0.7em;width:auto;min-width:122px;margin:0 10px;cursor:pointer;background:#090a0a !important;border:1px solid #fff !important;color:#ffffff !important;opacity:1 !important}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-btn button:hover{opacity:0.9 !important}
        </style>
    `,sn=()=>{const t=document.createElement("div");return t.className="software-log_shade",t.setAttribute("data-logger",""),t.innerHTML=on(),t},rn=()=>{const t=document.createElement("div");return t.className="software-log_shade__bg",t},ln=()=>{const t=document.createElement("div");return t.className="software-log_shade__pannel",t},cn=t=>{const e=document.createElement("div");return e.className="software-log_shade__pannel-title",e.textContent=t,e},un=t=>{const e=document.createElement("div");return e.className="software-log_shade__pannel-now",e.innerHTML=`<i>&nbsp;&nbsp;&nbsp;&nbsp;${t}</i>`,e},dn=()=>{const t=document.createElement("div");return t.className="software-log_shade__pannel-content",t},pn=t=>{const e=document.createElement("textarea");return e.setAttribute("readonly",""),e.setAttribute("cols","63"),e.setAttribute("rows","26"),e.setAttribute("wrap","on"),e.setAttribute("autocomplete","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false"),e.className="software-log_shade__pannel-content-text",e.value=t,e},_n=(t,e)=>{const n=document.createElement("button");return n.className="software-log_shade__pannel-btn-close",n.textContent=t,n.addEventListener("click",e),n},hn=()=>{const t=document.createElement("div");return t.className="software-log_shade__pannel-btn",t},gn=t=>{const e=t.title!=null?t.title:"\u65E5\u5FD7\u8BB0\u5F55",n=t.description!=null?t.description:"\u63D2\u4EF6\u5B89\u88C5/\u5378\u8F7D\u8FC7\u7A0B\u4E2D\u8BF7\u52FF\u5237\u65B0\u6B64\u9875\u9762!",a=t.clearText!=null?t.clearText:"\u5173\u95ED",o=t.value!=null?t.value:"",u=t.callback!=null?t.callback:()=>{};return{title:e,description:n,clearText:a,valueText:o,callback:u}},ue=t=>{const{title:e,description:n,clearText:a,valueText:o,callback:u}=gn(t);let i=!1,c="",l="",h=!1;const y=sn(),k=()=>{h||(document.body&&document.body.removeAttribute("lock-scroll"),u&&u(),y&&y.remove(),h=!0)},P=()=>{q.scrollTop=q.scrollHeight},V=S=>{q.value=`${c}
${S}`,P()},w=S=>{l=S,V(l)},p=S=>{w(l+S)},b=()=>{c+=".",w(l)},f=S=>{i=S,i?J.appendChild(te):J.removeChild(te)},C=()=>i,v=()=>{C()||setTimeout(()=>{T.getLog().then(S=>{switch(S==null?void 0:S.code){}const ne=S==null?void 0:S.stdout,G=S==null?void 0:S.stderr;(ne||G)&&w(`${ne}${G}`),b()}).catch(S=>{w(`${S}`)}).finally(()=>{v()})},500)};v();const $=rn(),m=ln(),x=cn(e),F=un(n),ee=dn(),q=pn(o);ee.appendChild(q);const J=hn(),te=_n(a,k);return m.append(x,F,ee,J),y.append($,m),document.body.appendChild(y),document.body.setAttribute("lock-scroll","true"),{close:k,setValue:w,addValue:p,setDisabled:f,getDisabled:C}},ce=t=>(re("data-v-c7ef5ab6"),t=t(),le(),t),fn={class:"app-container"},vn={class:"app-info"},mn={class:"app-f"},wn={class:"app-icon"},bn=["alt","src"],$n={class:"app-tags"},yn={class:"tag"},kn=ce(()=>s("span",{class:"block"},"\uFF5C",-1)),xn={class:"app-r"},Cn=["title"],Sn={class:"app-name"},Ln={class:"app-version"},An={class:"app-as"},Tn=ce(()=>s("span",{style:{margin:"0 10px"}},"|",-1)),En=["title"],In=["title"],Dn=["title"],Pn={class:"app-author"},Bn={class:"app-date"},Vn={class:"app-btns"},Fn=["href"],Mn=ce(()=>s("div",{class:"auto"},null,-1)),zn=ce(()=>s("div",{class:"app-margin-left"},null,-1)),Un=["href"],On=ce(()=>s("div",{class:"app-margin-left"},null,-1)),Rn={props:{col:{type:Object,default(){return{description:"",tags:[],entry:"",author:"",depends:[],installed:!1,hasupdate:!1,title:"",time:"",release:1,website:"",name:"",version:""}}}},setup(t){const e=t,{$gettext:n}=R(),a=B(()=>e.col),o=K(),u=U.formatDate,i=U.numberToSum,c=p=>{const b=ue({title:n("updating plugin"),description:n("do not refresh this page during plugin installation/uninstallation"),clearText:n("closed"),valueText:"",callback:()=>{location.reload()}});T.upgradeApp(p).then(f=>{let C=f.stdout,v=f.stderr;b.addValue(`${C}
${v}`),b.addValue(`
${n("the update is success, please close the current window")}`)}).catch(f=>{b.addValue(`${f}`),b.addValue(`
${n("update failed with error code")}: ${500}`)}).finally(()=>{b.setDisabled(!0);try{window.L.ui.menu.flushCache()}catch(f){}})},l=p=>{const b=ue({title:n("installing plugin"),description:n("do not refresh this page during plugin installation/uninstallation"),clearText:n("closed"),valueText:"",callback:()=>{location.reload()}});T.increasingDownloadCount(p),o.dispatch("apps/incrAppDownload",{name:p}),T.installApp(p).then(f=>{let C=f.stdout,v=f.stderr;b.addValue(`${C}
${v}`),b.addValue(`
${n("installation is complete, please close the current window")}`)}).catch(f=>{b.addValue(`${f}`),b.addValue(`
${n("installation failed, error code")}: ${500}`)}).finally(()=>{b.setDisabled(!0);try{window.L.ui.menu.flushCache()}catch(f){}})},h=p=>{if(!confirm(n("are you sure you want to uninstall %{name}?",{name:p})))return;const f=ue({title:n("uninstalling plugin"),description:n("do not refresh this page during plugin installation/uninstallation"),clearText:n("closed"),valueText:"",callback:()=>{location.reload()}});T.removeApp(p).then(C=>{let v=C.stdout,$=C.stderr;f.addValue(`${v}
${$}`),f.addValue(`
${n("uninstallation succeeded, please close the current window")}`)}).catch(C=>{f.addValue(`${C}`),f.addValue(`
${n("uninstall failed, error code")}: ${500}`)}).finally(()=>{f.setDisabled(!0);try{window.L.ui.menu.flushCache()}catch(C){}})},y=p=>L(this,null,function*(){H.Start();try{(yield T.postStarApp(p))&&o.dispatch("apps/incrAppStar",{name:p})}catch(b){}H.Stop()}),k=()=>{M(n("you have already liked"))},P=p=>a.value.installed?`/luci-static/resources/app-icons/${p}.png`:a.value.icon?T.getStoreAppIcon(a.value.icon):`/luci-static/resources/app-icons/${p}.png`,V=p=>{switch(window.vue_lang){case"zh-cn":case"zh-tw":return p.title}return p.title_en||p.title},w=p=>{switch(window.vue_lang){case"zh-cn":case"zh-tw":return p.description}return p.description_en||p.description};return(p,b)=>{var v,$,m,x,F,ee,q,J,te,S,ne;const f=se("svg-star-off"),C=se("svg-star-on");return d(),_("div",fn,[s("div",vn,[s("div",mn,[s("div",wn,[s("img",{alt:r(n)("Icon is gone")+"~",src:P(r(a).name)},null,8,bn)]),s("div",$n,[(d(!0),_(O,null,W(r(a).tags,G=>(d(),_(O,{key:G},[s("div",yn,[s("span",null,g(G),1)]),kn],64))),128))])]),s("div",xn,[s("div",{class:"app-title",title:r(a).name},[s("span",Sn,g(V(r(a))),1),s("span",Ln,"v"+g(r(a).version),1)],8,Cn),s("div",An,[s("span",null,g(r(n)("%{name} downloads",{name:r(i)(($=(v=r(a))==null?void 0:v.expand)==null?void 0:$.downloadCount)})),1),Tn,s("span",null,g(r(n)("%{name} links",{name:r(i)((x=(m=r(a))==null?void 0:m.expand)==null?void 0:x.starCount)})),1),((F=r(a))==null?void 0:F.expand)!=null?(d(),_(O,{key:0},[(q=(ee=r(a))==null?void 0:ee.expand)!=null&&q.isStar?(d(),_("a",{key:0,class:"star-btn",title:r(n)("liked"),onClick:b[0]||(b[0]=G=>k())},[N(f)],8,En)):(d(),_("a",{key:1,class:"star-btn",title:r(n)("like"),onClick:b[1]||(b[1]=G=>y(r(a).name))},[N(C)],8,In))],64)):z("",!0)]),s("div",{class:"app-description cbi-value-description",title:w(r(a))},[s("span",null,g(w(r(a))),1)],8,Dn),s("div",Pn,[s("span",null,g(r(n)("author"))+": "+g(r(a).author||"null"),1)]),s("div",Bn,[s("span",null,g(r(n)("update date"))+": "+g(r(u)(r(a).time*1e3)||"null"),1)])])]),s("div",Vn,[r(a).website?(d(),_("a",{key:0,class:"app-btn cbi-button cbi-button-apply",target:"_blank",href:r(a).website},g(r(n)("website")),9,Fn)):z("",!0),Mn,r(a).installed?(d(),_(O,{key:1},[((J=r(a))==null?void 0:J.curVersion)!=((te=r(a))==null?void 0:te.lastVersion)||((S=r(a))==null?void 0:S.curRelease)!=((ne=r(a))==null?void 0:ne.lastRelease)?(d(),_("a",{key:0,class:"app-btn cbi-button cbi-button-reload",onClick:b[2]||(b[2]=G=>c(r(a).name))},g(r(n)("upgrade")),1)):z("",!0),zn,r(a).entry?(d(),_("a",{key:1,class:"app-btn cbi-button cbi-button-apply",href:r(a).entry},g(r(n)("open")),9,Un)):z("",!0),On,s("a",{class:"app-btn cbi-button cbi-button-remove",onClick:b[3]||(b[3]=G=>h(r(a).name))},g(r(n)("uninstall")),1)],64)):(d(),_("a",{key:2,class:"app-btn cbi-button cbi-button-add",onClick:b[4]||(b[4]=G=>l(r(a).name))},g(r(n)("install")),1))])])}}};var ke=E(Rn,[["__scopeId","data-v-c7ef5ab6"]]);const Gn={class:"cbi-section"},Nn={class:"containers"},Hn={setup(t){const e=K(),n=B(()=>e.getters["apps/LocalApps"]);return(a,o)=>(d(),_("fieldset",Gn,[s("div",Nn,[(d(!0),_(O,null,W(r(n),u=>(d(),X(ke,{key:u.name,col:u},null,8,["col"]))),128))])]))}};var Kn=E(Hn,[["__scopeId","data-v-0046e0f2"]]);const Wn={class:"sort-container"},qn={class:"sort-title"},Zn={class:"sort-value"},Yn=["value","onClick"],Jn={setup(t){const{$gettext:e}=R(),n=A("default"),a=K(),o=A([{key:e("default"),value:"default"},{key:e("By download"),value:"download"},{key:e("By rating"),value:"star"}]),u=i=>{n.value=i,a.dispatch("apps/filterCurApps",{sort:i})};return(i,c)=>(d(),_("div",Wn,[s("div",qn,g(r(e)("order"))+":",1),s("div",Zn,[(d(!0),_(O,null,W(o.value,l=>(d(),_("input",{key:l.value,class:j(["cbi-button",{"cbi-button-apply":n.value==l.value}]),type:"button",value:l.key,onClick:h=>u(l.value)},null,10,Yn))),128))])]))}};var Qn=E(Jn,[["__scopeId","data-v-e3845a5c"]]);const Xn={class:"tags-container"},jn={class:"tags-title"},ea={class:"tags-value"},ta=["value"],na=["value","onClick"],aa={setup(t){const{$gettext:e}=R(),n=A("default"),a=K(),o=B(()=>a.getters["tags/Tags"]),u=i=>{n.value=i,a.dispatch("apps/filterCurApps",{tag:i})};return(i,c)=>(d(),_("div",Xn,[s("div",jn,g(r(e)("tag"))+": ",1),s("div",ea,[s("input",{class:j(["cbi-button",{"cbi-button-apply":n.value=="default"}]),type:"button",value:r(e)("default"),onClick:c[0]||(c[0]=l=>u("default"))},null,10,ta),(d(!0),_(O,null,W(r(o),l=>(d(),_("input",{key:l,class:j(["cbi-button",{"cbi-button-apply":n.value==l}]),type:"button",value:l,onClick:h=>u(l)},null,10,na))),128))])]))}};var oa=E(aa,[["__scopeId","data-v-3aaf04ee"]]);const sa=["onSubmit"],ra=["placeholder"],la={setup(t){const{$gettext:e}=R(),n=A(""),a=K(),o=()=>{a.dispatch("apps/filterCurApps",{search:n.value})};return(u,i)=>{const c=se("svg-search");return d(),_("form",{class:"search",onSubmit:ye(o,["prevent"])},[s("a",{class:"search-btn",onClick:o},[N(c)]),ie(s("input",{type:"text",placeholder:r(e)("please enter the search keyword"),"onUpdate:modelValue":i[0]||(i[0]=l=>n.value=l)},null,8,ra),[[$e,n.value,void 0,{trim:!0}]])],40,sa)}}};var ca=E(la,[["__scopeId","data-v-c4e8a9f2"]]);const ia={class:"containers"},ua={key:1,style:{margin:"10px 0","text-align":"center",width:"100%"}},da={setup(t){const{$gettext:e}=R(),n=K(),a=B(()=>n.getters["apps/StoreApps"]),o=B(()=>n.state.apps.Load);return(u,i)=>(d(),_("div",ia,[r(o)?(d(!0),_(O,{key:0},W(r(a),c=>(d(),X(ke,{key:c.name,col:c},null,8,["col"]))),128)):(d(),_("span",ua,g(r(e)("loading data"))+"...",1))]))}};var pa=E(da,[["__scopeId","data-v-1b494368"]]);const _a={class:"cbi-section"},ha={setup(t){return(e,n)=>(d(),_("fieldset",_a,[N(ca),N(oa),N(Qn),N(pa)]))}};var ga=E(ha,[["__scopeId","data-v-74b0669f"]]);const fa=t=>(re("data-v-9c880c04"),t=t(),le(),t),va={class:"cbi-section"},ma={class:"container_msg cbi-map-descr"},wa=["onSubmit"],ba={class:"upload-file"},$a={class:"button"},ya=fa(()=>s("div",{class:"auto"},null,-1)),ka={setup(t){const{$gettext:e}=R(),n=A(null),a=A(null);we(()=>{if(n.value){const c=n.value;c.addEventListener("dragenter",l=>{(l.fromElement===null||!c.contains(l.fromElement))&&console.log("dragenter")},!1),c.addEventListener("dragleave",l=>{(l.fromElement===null||!c.contains(l.fromElement))&&console.log("dragleave")},!1),c.addEventListener("dragover",l=>{l.preventDefault(),l.dataTransfer.dropEffect="link"},!1),c.addEventListener("drop",l=>{console.log("drop"),l.preventDefault(),o(l)},!1)}});const o=c=>{const l=c.dataTransfer.files;if(l&&l.length>0){const h=l[0];i(h);return}},u=c=>{const l=c.target.files;if(l&&l.length>0){const h=l[0];i(h);return}},i=c=>{if(c.name.endsWith(".run")||c.name.endsWith(".ipk")){const l=ue({title:e("uploading plugin"),description:e("do not refresh this page during plugin installation/uninstallation"),clearText:e("closed"),valueText:"",callback:()=>{location.reload()}});let h=new FormData;h.append(c.name,c),T.uploadAppIPK(h).then(y=>{let k=y.stdout,P=y.stderr;l.addValue(`${k}
${P}`),l.addValue(`
${e("offline installation is successful, please close the current window")}`)}).catch(y=>{l.addValue(`${y}`),l.addValue(`
${e("offline installation failed with error code")}: ${500}`)}).finally(()=>{l.setDisabled(!0);try{window.L.ui.menu.flushCache()}catch(y){}})}};return(c,l)=>{var h;return d(),_("fieldset",va,[s("div",ma,[s("span",null,g(r(e)("offline install")),1),s("span",null,"\xB7 "+g(r(e)("from this page, you can upload plugin packages to install plugins")),1),s("span",null,"\xB7 "+g(r(e)("support .ipk plug-in, .run self-extracting format")),1)]),s("form",{onSubmit:ye(i,["prevent"])},[s("div",{class:"flex",ref_key:"upl",ref:n},[s("label",ba,[s("span",null,g(((h=a.value)==null?void 0:h.name)||r(e)("no files selected")),1),s("input",{type:"file",name:"file",accept:".ipk, .run",hidden:"",onChange:u},null,32),s("div",$a,g(r(e)("select or drag and drop files")),1)]),ya],512)],40,wa)])}}};var xa=E(ka,[["__scopeId","data-v-9c880c04"]]);const Ca={class:"cbi-section"},Sa={class:"webapp-container"},La=["src"],Aa={setup(t){const e=B(()=>""),n=B(()=>""),a=B(()=>`${U.getIframeURL()}/#/apps?token=${n.value}&deviceId=${e.value}`);return(o,u)=>(d(),_("fieldset",Ca,[s("div",Sa,[s("iframe",{src:r(a),sandbox:"allow-scripts allow-same-origin allow-popups",seamless:""},null,8,La)])]))}};var Ta=E(Aa,[["__scopeId","data-v-8e330954"]]);const Ea={class:"log-containers"},Ia={key:0,class:"containers-tit"},Da={key:1,class:"containers-tit"},Pa=["value"],Ba={key:1},Va={setup(t){const{$gettext:e}=R(),n=K(),a=B(()=>n.state.version),o=B(()=>n.state.versionLoad),u=()=>{H.Start(`${e("updateing")}...`),T.selfUpdateIstore().then(({data:i})=>{if(i){const{stdout:c,stderr:l,code:h}=i;if(h==0){M(e("update success")),n.dispatch("istoreUpdated");return}else throw l||"unknown error"}throw"unknown error"}).catch(i=>{M(`${e("update error")}: ${i}`)}).finally(()=>{H.Stop()})};return(i,c)=>(d(),_("div",Ea,[r(o)?(d(),_("div",Da,[r(a)?(d(),_(O,{key:0},[s("span",null,g(r(e)("last version"))+":"+g(r(a)),1),s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:c[0]||(c[0]=l=>u()),value:r(e)("click to update")},null,8,Pa)],64)):(d(),_("span",Ba,g(r(e)("the is last version"))+"...",1))])):(d(),_("div",Ia,g(r(e)("checking for latest version")),1))]))}};var Fa=E(Va,[["__scopeId","data-v-8f2ad39a"]]),Ma={namespaced:!0,state:{Load:!1,LocalApps:[],StoreApps:[],Expand:{},Cur:{tag:"default",sort:"default",search:"",limit:30,offset:0},LocalAppsMap:{},StoreAppsMap:{}},mutations:{setExpand(t,e){t.Expand=e},setLocalApps(t,e){t.LocalApps=e||[],e.forEach(n=>{t.LocalAppsMap[n.name]=n})},setStoreApps(t,e){t.StoreApps=e||[],e.forEach(n=>{t.StoreAppsMap[n.name]=n})},setCur(t,e){for(const n in e)Object.hasOwnProperty.call(e,n)&&(t.Cur[n]=e[n])}},getters:{Cur(t){return t.Cur},LocalApps(t){let e=[...t.LocalApps],n=t.Expand;for(let a=0;a<e.length;a++){let o=e[a].name;n[o]&&(e[a].expand=n[o]),t.StoreAppsMap[o]&&(e[a].curVersion=e[a].version,e[a].curRelease=e[a].release,e[a].lastVersion=t.StoreAppsMap[o].version,e[a].lastRelease=t.StoreAppsMap[o].release)}return e},StoreApps(t){var i,c,l,h,y,k,P,V;let e=[...t.StoreApps],n=t.Expand;for(let w=0;w<e.length;w++){let p=e[w].name;n[p]&&(e[w].expand=n[p]),t.LocalAppsMap[p]&&(e[w].installed=!0,e[w].lastVersion=e[w].version,e[w].lastRelease=e[w].release,e[w].curVersion=t.LocalAppsMap[p].version,e[w].curRelease=t.LocalAppsMap[p].release)}let a=t.Cur.tag;if(a!="default"){let w=[];e.forEach(p=>{p.tags&&p.tags.forEach(b=>{b==a&&w.push(p)})}),e=w}let o=t.Cur.search;if(o){let w=[];e.forEach(p=>{let b=JSON.stringify(p);new RegExp(o,"i").test(b)&&w.push(p)}),e=w}let u=e.length;switch(t.Cur.sort){case"download":for(let w=0;w<u-1;w++)for(let p=0;p<u-1-w;p++){let b=((c=(i=e[p])==null?void 0:i.expand)==null?void 0:c.downloadCount)||0,f=((h=(l=e[p+1])==null?void 0:l.expand)==null?void 0:h.downloadCount)||0;if(b<f){let C=e[p];e[p]=e[p+1],e[p+1]=C}}break;case"star":for(let w=0;w<u-1;w++)for(let p=0;p<u-1-w;p++){let b=((k=(y=e[p])==null?void 0:y.expand)==null?void 0:k.starCount)||0,f=((V=(P=e[p+1])==null?void 0:P.expand)==null?void 0:V.starCount)||0;if(b<f){let C=e[p];e[p]=e[p+1],e[p+1]=C}}break}return e}},actions:{incrAppDownload(t,e){const{state:n}=t;n.Expand[e==null?void 0:e.name]&&n.Expand[e==null?void 0:e.name].downloadCount++},incrAppStar(t,e){const{state:n}=t;n!=null&&n.Expand[e==null?void 0:e.name]&&(n.Expand[e==null?void 0:e.name].starCount++,n.Expand[e==null?void 0:e.name].isStar=!0)},filterCurApps(t,e){const{commit:n,dispatch:a}=t;n("setCur",e)},getApps(t){const{state:e,dispatch:n}=t;n("getLocalApps"),n("getStoreApps",e.Cur)},getLocalApps(t){const{commit:e}=t;T.getInstalledApp().then(n=>{n.forEach(a=>{a.installed=!0}),e("setLocalApps",n)})},getStoreApps(t,e){const{state:n,commit:a,dispatch:o}=t;let u=[];T.getStoreAppList(e).then(i=>{i.apps&&(i.apps.forEach(c=>{u.push(c.name)}),o("getStoreAppsExpand",u),a("setStoreApps",i.apps)),n.Load=!0}).catch(i=>{console.log(i)})},getStoreAppsExpand(t,e){const{commit:n}=t;T.getAppExpandData(e).then(a=>{a&&n("setExpand",a)})}}},za={namespaced:!0,state:{Tags:[],Total:0},mutations:{},getters:{Tags(t){return t.Tags},Total(t){return t.Total}},actions:{getTags(t){const{state:e,commit:n}=t;T.getStoreTags().then(a=>{e.Tags=(a==null?void 0:a.tags)||[],e.Total=(a==null?void 0:a.total)||0})}}},Ua={namespaced:!0,state:{status:!1,action:"install",content:"",end:!1,exitCode:void 0},mutations:{setStatus(t,e){t.status=e.status,t.action=(e==null?void 0:e.action)||"install",t.content=(e==null?void 0:e.content)||"",t.end=(e==null?void 0:e.end)||!1,t.exitCode=void 0},setContent(t,e){t.content=e},setEnd(t,e){t.end=!0,t.exitCode=e}},getters:{},actions:{}},oe=Be({state:{version:"",versionLoad:!1},mutations:{setVersion(t,e){t.version=e},setVersionLoad(t,e){t.versionLoad=e}},modules:{apps:Ma,tags:za,log:Ua},actions:{getData(t){const{dispatch:e}=t;e("tags/getTags"),e("apps/getApps"),e("getVersion")},getVersion(t){return L(this,null,function*(){const{commit:e}=t;try{const n=yield T.updateIstore(),{code:a,msg:o}=n==null?void 0:n.data;a==200&&e("setVersion",o)}catch(n){console.log(n)}e("setVersionLoad",!0)})},istoreUpdated(t){const{commit:e}=t;e("setVersion","")}}}),ae={Start(t,e){oe.commit("log/setStatus",{status:!0,action:t,content:""})},Stop(){oe.commit("log/setStatus",{status:!1,action:"install",content:""})},Add(t){oe.commit("log/setContent",t)},End(t){oe.commit("log/setEnd",t)}};const Oa={class:"Lightweight"},Ra={class:"Lightweight-container"},Ga={class:"model"},Na={class:"Lightweight-container1"},Ha={class:"container1-center"},Ka={class:"Lightweight-tit"},Wa={class:"Lightweight-backup"},qa=["value"],Za=["value"],Ya={setup(t){const{$gettext:e}=R(),n=A(null),a=()=>{const c=e("backuping"),l=e("backup success"),h=e("backup fail"),y=e("click to download");H.Start(`${c}...`),T.lightBackup().then(k=>{if(k){const{msg:P,code:V}=k;if(V==200){M({content:`${l}\uFF0C<a href="/cgi-bin/luci/admin/store/get_light_backup_file" target="_blank">${y}</a><br/><br/>`,keep:!0,html:!0});return}else throw P||"unknown error"}throw"unknown error"}).catch(k=>{M(`${h} : ${k}`)}).finally(()=>{H.Stop()})},o=c=>{const l=c.target.files;if(l&&l.length>0){const h=l[0];u(h);return}},u=c=>{let l=new FormData;l.append(c.name,c),ae.Start("upload"),T.lightRestore(l).then(h=>{let y=h.stdout,k=h.stderr;ae.Add(`${y}
${k}`),ae.End(h.code)}).catch(h=>{ae.Add(h),ae.End(500)})},i=c=>{n.value.click(c),c.preventDefault()};return(c,l)=>(d(),_("div",Oa,[s("div",Ra,[s("div",Ga,g(r(e)("explain")),1),s("div",Na,[s("div",Ha,[s("div",Ka,[s("span",null,"\xB7 "+g(r(e)("backup now will download a list of iStore installed software")),1),s("span",null,"\xB7 "+g(r(e)("upload software list and install from iStore when restoring backup")),1)]),s("div",Wa,[s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:a,value:r(e)("backup now")},null,8,qa),s("input",{type:"file",name:"file",accept:".tar, .gz",hidden:"",onChange:o,ref_key:"upl",ref:n},null,544),s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:i,value:r(e)("restore backup")},null,8,Za)])])])])]))}};var Ja=E(Ya,[["__scopeId","data-v-0f5d170b"]]);const Qa={class:"local"},Xa={class:"local-container"},ja={class:"model"},eo={class:"local-container1"},to={class:"container1-center"},no={class:"local-tit"},ao={class:"local-device"},oo={class:"local-input"},so={value:"",disabled:""},ro=["value"],lo={value:"-"},co=["onKeyup","placeholder"],io={key:2,class:"local-btn"},uo=["value"],po=["value"],_o={key:0,class:"device-list"},ho=["value"],go=["value"],fo={setup(t){const{$gettext:e}=R(),n=e("backup now backs up installed software (unlimited installation sources) to external storage"),a=A([]),o=A("-");let u="-";const i=A(!1),c=A([]),l=A(""),h=A(""),y=A(),k=(v,$)=>{if(!($===""||$==="-"||v.find(m=>m.path===$))){let m;v.filter(x=>x.mount&&x.dev&&$.startsWith(x.mount)).forEach(x=>{m&&m.mount.length>x.mount.length||(m=x)}),v.push({path:$,size:m?m.size:void 0})}a.value=v,$!=="-"&&(o.value=$,P())};o.value=="-"&&(T.localBackupdirPath().then(v=>{if(v){const{code:$,msg:m}=v;$==200&&k(a.value,m)}}),T.getBlockDevices().then(v=>{if(v&&v.code==200){const $=v.data,m=[];for(let x in $){const F=$[x];F.mount&&F.mount!="/"&&F.mount!="/rom"&&F.mount!="/overlay"&&m.push(F)}m.forEach(x=>{x.path=x.mount+"/istore_backup"}),k(m,m.length>0&&o.value==="-"?"":o.value)}}));const P=v=>{i.value=!1,o.value==="-"?(u!="-"&&(h.value=u),y.value.focus()):u=o.value},V=v=>{h.value==""?u!="-"?o.value=u:o.value="":h.value.startsWith("/")?k(a.value,h.value):(M(e("please enter the path, give up the input, please clear the input box")),y.value.setSelectionRange(0,h.value.length),y.value.focus())},w=()=>o.value.length>1&&o.value.endsWith("/")?o.value.substring(0,o.value.length-1):o.value,p=()=>{let v=w();if(v==""){M(e("please fill in the external storage directory"));return}i.value=!1,T.backupFileList(v).then($=>{if($){const{code:m,msg:x}=$;if(m==200){let F=JSON.parse(x);F.length==0?(M(e("there are no backup files in this path")),i.value=!1):(c.value=F,i.value=!0);return}throw x||"unknown error"}throw"unknown error"}).catch($=>{M($)})},b=()=>{let v=w();if(v==""){M(e("please fill in the external storage directory"));return}H.Start(`${e("backuping")}...`),T.localBackup(v).then($=>{if($){const{msg:m,code:x,stderr:F}=$;if(x==0){M(e("backup success"));return}else throw x==500?m:F||"unknown error"}throw"unknown error"}).catch($=>{M(`${e("backup fail")}: ${$}`)}).finally(()=>{H.Stop()})},f=v=>o.value.endsWith("/")?o.value+v:o.value+"/"+v,C=()=>{if(l.value===""){M(e("please select a backup file to restore"));return}H.Start(`${e("restoring backup")}...`),T.localRestore(f(l.value)).then(v=>{if(v){const{msg:$,stderr:m,code:x}=v;if(x==0){M(e("the backup was restored success"));return}else throw $||m||"unknown error"}throw"unknown error"}).catch(v=>{M(`${e("the backup was restored fail")}: ${v}`)}).finally(()=>{H.Stop()})};return(v,$)=>(d(),_("div",Qa,[s("div",Xa,[s("div",ja,g(r(e)("explain")),1),s("div",eo,[s("div",to,[s("div",no,[s("span",null,"\xB7 "+g(r(e)(r(n))),1),s("span",null,"\xB7 "+g(r(e)("no internet required for recovery")),1)]),s("div",ao,g(r(e)("external storage directory"))+" \uFF1A ",1),s("div",oo,[o.value!="-"?ie((d(),_("select",{key:0,class:"local-input-field",onChange:P,"onUpdate:modelValue":$[0]||($[0]=m=>o.value=m)},[s("option",so,g(r(e)("choose")),1),(d(!0),_(O,null,W(a.value,(m,x)=>(d(),_("option",{value:m.path,key:x},g(m.path+(m.size?"\uFF08"+m.size+"\uFF09":"")),9,ro))),128)),s("option",lo,g(r(e)("customize")),1)],544)),[[ve,o.value,void 0,{trim:!0}]]):ie((d(),_("input",{key:1,class:"local-input-field",onBlur:V,onKeyup:Ve(V,["enter"]),placeholder:r(e)("please enter an absolute path starting with %{name}",{name:"/"}),type:"text","onUpdate:modelValue":$[1]||($[1]=m=>h.value=m),ref_key:"user_input",ref:y},null,40,co)),[[$e,h.value,void 0,{trim:!0}]]),o.value!="-"&&o.value!=""?(d(),_("div",io,[s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:b,value:r(e)("backup now")},null,8,uo),s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:p,value:r(e)("restore backup")},null,8,po)])):z("",!0)]),i.value?(d(),_("div",_o,[s("div",null,g(r(e)("choose backup file"))+" \uFF1A",1),ie(s("select",{"onUpdate:modelValue":$[2]||($[2]=m=>l.value=m)},[(d(!0),_(O,null,W(c.value,m=>(d(),_("option",{key:m,value:m},g(m),9,ho))),128))],512),[[ve,l.value,void 0,{trim:!0}]]),s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:C,value:r(e)("restore now")},null,8,go)])):z("",!0)])])])]))}};var vo=E(fo,[["__scopeId","data-v-745c433e"]]);const mo={class:"cbi-map"},wo={class:"cbi-section"},bo={class:"panel-title"},$o={class:"cbi-section"},yo={class:"panel-title"},ko={class:"cbi-tabmenu"},xo={onclick:"false",href:"#"},Co={onclick:"false",href:"#"},So={setup(t){const{$gettext:e}=R(),n=A(2);return(a,o)=>(d(),_("div",mo,[s("fieldset",wo,[s("span",bo,g(r(e)("upgrade"))+" iStore",1),N(Fa)]),s("fieldset",$o,[s("span",yo,g(r(e)("app backup")),1),s("ul",ko,[s("li",{class:j(n.value==2?"cbi-tab":"cbi-tab-disabled"),onClick:o[0]||(o[0]=u=>n.value=2)},[s("a",xo,g(r(e)("light backup")),1)],2),s("li",{class:j(n.value==3?"cbi-tab":"cbi-tab-disabled"),onClick:o[1]||(o[1]=u=>n.value=3)},[s("a",Co,g(r(e)("local backup")),1)],2)]),n.value==2?(d(),X(Ja,{key:0})):z("",!0),n.value==3?(d(),X(vo,{key:1})):z("",!0)])]))}};var Lo=E(So,[["__scopeId","data-v-1d5c62fe"]]);const Ao=Fe({history:Me(U.BasePage()),routes:[{path:"/",redirect:"/installed"},{path:"/installed",name:"Installed",component:Kn},{path:"/store",name:"Store",component:ga},{path:"/upload",name:"Upload",component:xa},{path:"/webapps",name:"Webapps",component:Ta},{path:"/maintance",name:"Maintance",component:Lo},{path:"/:pathMatch(.*)*",name:"notfound",redirect:"/"}]}),To={},Eo={width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},Io=s("path",{d:"M14.9234958,14.5525054 L10.84453,10.4679606 C11.8849284,9.46327833 12.5294813,8.07823887 12.5294813,6.55073066 C12.5294813,3.48989918 9.94358337,1 6.76474066,1 C3.58589795,1 1,3.48989918 1,6.55073066 C1,9.61156213 3.58589795,12.1014613 6.76474066,12.1014613 C8.16008242,12.1014613 9.44067838,11.621191 10.438802,10.8242646 L14.5276502,14.9188536 C14.5814545,14.9730393 14.6533765,15 14.725573,15 C14.7942009,15 14.8625542,14.9754182 14.9158095,14.9262546 C15.025065,14.8250198 15.0283592,14.6577049 14.9234958,14.5525054 Z M6.76474066,11.5728203 C3.8886841,11.5728203 1.54902292,9.32001661 1.54902292,6.55073066 C1.54902292,3.7814447 3.8886841,1.52864101 6.76474066,1.52864101 C9.64079723,1.52864101 11.9804584,3.7814447 11.9804584,6.55073066 C11.9804584,9.32001661 9.64052272,11.5728203 6.76474066,11.5728203 Z",id:"Shape",stroke:"#FFFFFF","stroke-width":"1.3"},null,-1),Do=[Io];function Po(t,e,n,a,o,u){return d(),_("svg",Eo,Do)}var Bo=E(To,[["render",Po]]);const Vo={},Fo={width:"12px",height:"12px",viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},Mo=s("path",{d:"M10.171916,3.81818329 C10.6519813,3.81274681 11.1102149,4.01840688 11.4252438,4.38069009 C11.7402726,4.74297329 11.8803105,5.2253253 11.8081406,5.70080197 L11.0555552,10.608963 C10.9332063,11.4157454 10.2351606,12.0090843 9.42537185,12 L3.27269856,12 C2.97145497,12 2.7272488,11.7556885 2.7272488,11.454445 L2.7272488,5.4544976 C2.7272488,5.37817917 2.74326442,5.30271013 2.77426027,5.23296947 L4.95605931,0.323921631 C5.04360472,0.126944443 5.23894201,0 5.4544976,0 C6.65947193,0 7.63629663,0.976824702 7.63629663,2.18179904 L7.63629663,3.81815451 L10.171916,3.81818329 Z M3.81814832,10.9090654 L9.43153778,10.9090654 C9.70352269,10.9121048 9.93620458,10.7143252 9.97712277,10.4445109 L10.7297188,5.53628009 C10.7537339,5.3780602 10.7070546,5.2172762 10.602045,5.09651513 C10.4970353,4.97575406 10.3442908,4.9072007 10.1780925,4.90904784 L7.09084687,4.90904784 C6.78960329,4.90904784 6.54539711,4.66484166 6.54539711,4.36359808 L6.54539711,2.18179904 C6.54539711,1.69494967 6.22647822,1.2825878 5.78615711,1.14223013 L3.81814832,5.57024992 L3.81814832,10.9090654 Z M2.7272488,5.99994736 L1.63634928,5.99994736 C1.33510569,5.99994736 1.09089952,6.24415353 1.09089952,6.54539711 L1.09089952,10.3635454 C1.09089952,10.664789 1.33510569,10.9089952 1.63634928,10.9089952 L2.7272488,10.9089952 L2.7272488,5.99994736 Z M3.27269856,11.9998947 L1.63634928,11.9998947 C0.732618527,11.9998947 -1.03028697e-13,11.2672762 -1.03028697e-13,10.3635454 L-1.03028697e-13,6.54539711 C-1.03028697e-13,5.64166636 0.732618527,4.90904784 1.63634928,4.90904784 L3.27269856,4.90904784 C3.57394214,4.90904784 3.81814832,5.15325401 3.81814832,5.4544976 L3.81814832,11.454445 C3.81814832,11.7556885 3.57394214,11.9998947 3.27269856,11.9998947 Z",id:"Shape",fill:"#FFFFFF","fill-rule":"nonzero"},null,-1),zo=[Mo];function Uo(t,e,n,a,o,u){return d(),_("svg",Fo,zo)}var Oo=E(Vo,[["render",Uo]]);const Ro={},Go={width:"12px",height:"12px",viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},No=s("path",{d:"M10.171916,3.81818329 C10.6519813,3.81274681 11.1102149,4.01840688 11.4252438,4.38069009 C11.7402726,4.74297329 11.8803105,5.2253253 11.8081406,5.70080197 L11.0555552,10.608963 C10.9332063,11.4157454 10.2351606,12.0090843 9.42537185,12 L3.27269856,12 C2.97145497,12 2.7272488,11.7556885 2.7272488,11.454445 L2.7272488,5.4544976 C2.7272488,5.37817917 2.74326442,5.30271013 2.77426027,5.23296947 L4.95605931,0.323921631 C5.04360472,0.126944443 5.23894201,0 5.4544976,0 C6.65947193,0 7.63629663,0.976824702 7.63629663,2.18179904 L7.63629663,3.81815451 L10.171916,3.81818329 Z M3.27269856,11.9998947 L1.63634928,11.9998947 C0.732618527,11.9998947 0,11.2672762 0,10.3635454 L0,6.54539711 C0,5.64166636 0.732618527,4.90904784 1.63634928,4.90904784 L3.27269856,4.90904784 C3.57394214,4.90904784 3.81814832,5.15325401 3.81814832,5.4544976 L3.81814832,11.454445 C3.81814832,11.7556885 3.57394214,11.9998947 3.27269856,11.9998947 Z",id:"Shape",fill:"#FFE45A","fill-rule":"nonzero"},null,-1),Ho=[No];function Ko(t,e,n,a,o,u){return d(),_("svg",Go,Ho)}var Wo=E(Ro,[["render",Ko]]);const Q=_e(Ht);Q.component("svg-search",Bo);Q.component("svg-star-on",Oo);Q.component("svg-star-off",Wo);const qo=()=>L(I,null,function*(){yield Ue(Q),Q.use(Ao).use(oe),Q.mount("#app")});qo()});export default Zo();
