var Ct=Object.defineProperty,St=Object.defineProperties;var Lt=Object.getOwnPropertyDescriptors;var gt=Object.getOwnPropertySymbols;var At=Object.prototype.hasOwnProperty,Tt=Object.prototype.propertyIsEnumerable;var ft=(e,t,n)=>t in e?Ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Z=(e,t)=>{for(var n in t||(t={}))At.call(t,n)&&ft(e,n,t[n]);if(gt)for(var n of gt(t))Tt.call(t,n)&&ft(e,n,t[n]);return e},dt=(e,t)=>St(e,Lt(t));var Et=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var L=(e,t,n)=>new Promise((a,o)=>{var l=c=>{try{i(n.next(c))}catch(h){o(h)}},u=c=>{try{i(n.throw(c))}catch(h){o(h)}},i=c=>c.done?a(c.value):Promise.resolve(c.value).then(l,u);i((n=n.apply(e,t)).next())});import{a as pt,c as It,u as R,b as K,d as B,r as st,o as d,e as _,F as O,f as W,g as X,w as Dt,h as r,p as rt,i as lt,j as s,t as g,k as z,n as j,l as Pt,m as A,q as mt,s as Bt,v as N,x as _t,y as wt,z as it,A as bt,B as $t,C as Vt,D as vt,E as Mt,G as Ft,H as zt}from"./vendor.js?v=64c6a109";var Zo=Et(I=>{const Ut=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&a(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}};Ut();let yt={};const Ot=e=>L(I,null,function*(){const t=window.vue_lang;new Date().getTime();let n={};try{const l=yield pt({url:window.vue_lang_data,method:"GET"});l.data&&(n=l.data)}catch(l){console.log(l)}const a=It({defaultLanguage:t,translations:n,setGlobalProperties:!1,provideDirective:!1,provideComponent:!1});e.use(a);const{$gettext:o}=a;yt={net:o("net"),tool:o("tool"),download:o("download"),service:o("service"),multimedia:o("multimedia"),nas:o("nas"),monitor:o("monitor"),system:o("system"),networking:o("networking")}}),kt=e=>yt[e]||e;var E=(e,t)=>{const n=e.__vccOpts||e;for(const[a,o]of t)n[a]=o;return n};const Rt=e=>(rt("data-v-13251538"),e=e(),lt(),e),Gt={class:"tabs"},Nt=["href","onClick"],Ht={key:0},Kt=Rt(()=>s("div",{class:"auto"},null,-1)),Wt={setup(e){const{$gettext:t}=R(),n=K(),a=B(()=>n.state.version),o=B(()=>[{to:"/installed",name:t("installed")},{to:"/store",name:t("all app")},{to:"/upload",name:t("manual install")},{to:"/maintance",name:t("maintain"),up:a.value}]);return(l,u)=>{const i=st("router-link");return d(),_("ul",Gt,[(d(!0),_(O,null,W(r(o),c=>(d(),X(i,{to:c.to,custom:"",key:c.to},{default:Dt(({href:h,navigate:y,isActive:k})=>[s("li",{class:j(k&&"active cbi-tab")},[s("a",{href:h,onClick:y},g(c.name),9,Nt),c.up?(d(),_("span",Ht)):z("",!0)],2)]),_:2},1032,["to"]))),128)),Kt])}}};var qt=E(Wt,[["__scopeId","data-v-13251538"]]);const Zt=()=>window.vue_base,Yt=()=>window.istore_api_base||"https://istore.linkease.com",Jt=e=>{if(e)return Pt(e).format("YYYY-MM-DD HH:mm:ss")},Qt=()=>new Date().getTime(),Xt=e=>{if(e<1024)return""+e+"KB";let n=1024,a=0;for(let l=e/1024;l>=1024;l/=1024)n*=1024,a++;let o=["M","G","T","P","E"];return(e/100/(n/100)).toFixed(2)+o[a]},jt=e=>{if(e==null)return 0;if(e<1e4)return e;let n=parseInt(`${e/1e4}`),a=e%1e4;return`${n}\u4E07${a}`},te=()=>window.token||"",ee=()=>{var e;return((e=window==null?void 0:window.device_id)==null?void 0:e.uid)||""},ne=()=>{var e;return((e=window==null?void 0:window.device_id)==null?void 0:e.version)||""},ae=()=>{var e;return((e=window==null?void 0:window.device_id)==null?void 0:e.arch)||""},oe=()=>"https://www.kooldns.cn/bind";var se=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",BasePage:Zt,ApiBaseURL:Yt,formatDate:Jt,UnixDate:Qt,numberToSize:Xt,numberToSum:jt,getToken:te,getDeviceId:ee,getVersion:ne,modelArch:ae,getIframeURL:oe}),U=Z({},se);const D=pt.create({});D.interceptors.request.use(e=>(e.params==null&&(e.params={}),e.params=dt(Z({},e.params),{token:U.getToken(),_t:U.UnixDate()}),e),e=>e);D.interceptors.response.use(e=>e,e=>e);const Y=pt.create({baseURL:U.ApiBaseURL()});Y.interceptors.request.use(e=>(e.params==null&&(e.params={}),e.params=dt(Z({},e.params),{modelArch:U.modelArch(),deviceId:U.getDeviceId(),_t:U.UnixDate()}),e),e=>e);Y.interceptors.response.use(e=>e);const re=()=>new Promise((e,t)=>L(I,null,function*(){try{const n=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/installed"});if(n.status==200){e(n.data);return}t(n.status);return}catch(n){t(n);return}})),le=e=>new Promise((t,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/install",params:{package:e}});if(a.status==200){t(a.data);return}n(a.status);return}catch(a){n(a);return}})),ce=e=>new Promise((t,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/upgrade",params:{package:e}});if(a.status==200){t(a.data);return}n(a.status);return}catch(a){n(a);return}})),ie=e=>new Promise((t,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/remove",params:{package:e}});if(a.status==200){t(a.data);return}n(a.status);return}catch(a){n(a);return}})),ue=()=>new Promise((e,t)=>L(I,null,function*(){try{const n=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/update"});if(n.status==200){e(n.data);return}t(n.status);return}catch(n){t(n);return}})),de=e=>new Promise((t,n)=>L(I,null,function*(){try{const a=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/status",params:{package:e}});if(a.status==200){t(a.data);return}n(a.status);return}catch(a){n(a);return}})),pe=()=>new Promise((e,t)=>L(I,null,function*(){try{const n=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/log"});if(n.status==200){e(n.data);return}t(n.status);return}catch(n){t(n);return}})),_e=e=>new Promise((t,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/upload",headers:{"Content-Type":"multipart/form-data"},data:e});if(a.data){t(a.data);return}}catch(a){n(a);return}n("not found soft")})),he=()=>new Promise((e,t)=>L(I,null,function*(){try{const n=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/light_backup"});if(n.status==200){e(n.data);return}t(n.status);return}catch(n){t(n);return}})),ge=e=>new Promise((t,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/light_restore",headers:{"Content-Type":"multipart/form-data"},data:e});if(a.data){t(a.data);return}}catch(a){n(a);return}n("not found soft")})),fe=e=>new Promise((t,n)=>L(I,null,function*(){try{const a=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/get_available_backup_file_list",params:{path:e}});if(a.status==200){t(a==null?void 0:a.data);return}n(a.status);return}catch(a){n(a);return}})),ve=()=>new Promise((e,t)=>L(I,null,function*(){try{const n=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/get_local_backup_dir_path"});if(n.status==200){e(n==null?void 0:n.data);return}t(n.status);return}catch(n){t(n);return}})),me=(e,t)=>new Promise((n,a)=>L(I,null,function*(){try{const o=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/local_backup",params:{path:e,force:t}});if(o.status==200){n(o==null?void 0:o.data);return}a(o.status);return}catch(o){a(o);return}})),we=e=>new Promise((t,n)=>L(I,null,function*(){try{const a=yield D({method:"POST",url:"/cgi-bin/luci/admin/store/local_restore",params:{path:e}});if(a.status==200){t(a.data);return}n(a.status);return}catch(a){n(a);return}})),be=()=>new Promise((e,t)=>L(I,null,function*(){try{const n=yield D({method:"GET",url:"/cgi-bin/luci/admin/store/get_block_devices"});if(n.status==200){e(n==null?void 0:n.data);return}t(n.status);return}catch(n){t(n);return}}));var $e=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getInstalledApp:re,installApp:le,upgradeApp:ce,removeApp:ie,updateAppStore:ue,getAppStatus:de,getLog:pe,uploadAppIPK:_e,lightBackup:he,lightRestore:ge,backupFileList:fe,localBackupdirPath:ve,localBackup:me,localRestore:we,getBlockDevices:be});const ye=e=>new Promise((t,n)=>L(I,null,function*(){var a,o,l,u;try{const i=yield Y({method:"GET",url:"/api/store/list",params:e});if(((a=i==null?void 0:i.data)==null?void 0:a.success)===0){t((o=i==null?void 0:i.data)==null?void 0:o.result);return}if((l=i==null?void 0:i.data)!=null&&l.message){n((u=i==null?void 0:i.data)==null?void 0:u.message);return}n("error")}catch(i){console.log(i),n(i);return}})),ke=U.ApiBaseURL(),xe=e=>`${ke}${e}`,Ce=()=>new Promise((e,t)=>L(I,null,function*(){var n,a,o,l;try{const u=yield Y({method:"GET",url:"/api/store/tags"});if(((n=u==null?void 0:u.data)==null?void 0:n.success)===0){e((a=u==null?void 0:u.data)==null?void 0:a.result);return}if((o=u==null?void 0:u.data)!=null&&o.message){t((l=u==null?void 0:u.data)==null?void 0:l.message);return}t("error")}catch(u){t(u);return}})),Se=e=>new Promise((t,n)=>{Y({method:"POST",url:"/api/store/expand",data:{appsId:e||[],deviceId:U.getDeviceId()}}).then(a=>{var o,l,u;if(((o=a.data)==null?void 0:o.success)==0&&((l=a.data)==null?void 0:l.result)){t((u=a.data)==null?void 0:u.result);return}n("not found expand")}).catch(a=>{n(a)})}),Le=e=>{Y({method:"POST",url:"/api/store/download",data:{appId:e,deviceId:U.getDeviceId()}}).then(t=>{var n;((n=t.data)==null?void 0:n.success)!=0})},Ae=e=>new Promise((t,n)=>{Y({method:"POST",url:"/api/store/star",data:{appId:e,deviceId:U.getDeviceId()}}).then(a=>{var o;if(((o=a.data)==null?void 0:o.success)==0){t(a.data);return}n("not found expand")}).catch(a=>{n(a)})});var Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",getStoreAppList:ye,getStoreAppIcon:xe,getStoreTags:Ce,getAppExpandData:Se,increasingDownloadCount:Le,postStarApp:Ae});const Ee=()=>D({method:"GET",url:"/cgi-bin/luci/admin/store/check_self_upgrade"}),Ie=()=>D({method:"POST",url:"/cgi-bin/luci/admin/store/do_self_upgrade"});var De=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",updateIstore:Ee,selfUpdateIstore:Ie}),T=Z(Z(Z({},$e),Te),De);const Pe={setup(){const e=K(),t=B(()=>e.state.log.action),n=B(()=>e.state.log.content),a=B(()=>e.state.log.end),o=B(()=>e.state.log.exitCode),l=A(!1),u=A(null);let i="",c=A(""),h=A("."),y="",k="";switch(t.value){case"install":i="\u6B63\u5728\u5B89\u88C5\u63D2\u4EF6",y="\u5B89\u88C5\u5B8C\u6210,\u8BF7\u5173\u95ED\u5F53\u524D\u7A97\u53E3",k="\u5B89\u88C5\u5931\u8D25,\u9519\u8BEF\u7801";break;case"uninstall":i="\u6B63\u5728\u5378\u8F7D\u63D2\u4EF6",y="\u5378\u8F7D\u6210\u529F,\u8BF7\u5173\u95ED\u5F53\u524D\u7A97\u53E3",k="\u5378\u8F7D\u5931\u8D25,\u9519\u8BEF\u7801";break;case"upgrade":i="\u6B63\u5728\u66F4\u65B0\u63D2\u4EF6",y="\u66F4\u65B0\u6210\u529F,\u8BF7\u5173\u95ED\u5F53\u524D\u7A97\u53E3",k="\u66F4\u65B0\u5931\u8D25,\u9519\u8BEF\u7801";break;case"upload":i="\u6B63\u5728\u4E0A\u4F20\u63D2\u4EF6",y="\u79BB\u7EBF\u5B89\u88C5\u6210\u529F,\u8BF7\u5173\u95ED\u5F53\u524D\u7A97\u53E3",k="\u79BB\u7EBF\u5B89\u88C5\u5931\u8D25,\u9519\u8BEF\u7801";break}mt(()=>{document.body.setAttribute("lock-scroll",!0),V()}),Bt(()=>{document.body.removeAttribute("lock-scroll")});const P=()=>{var f;(f=u.value)!=null&&f.scrollHeight&&(u.value.scrollTop=u.value.scrollHeight)},V=()=>{setTimeout(()=>{if(a.value){w(),P();return}T.getLog().then(f=>{if(a.value){w(),P();return}switch(f==null?void 0:f.code){}const C=f==null?void 0:f.stdout,v=f==null?void 0:f.stderr;(C||v)&&(c.value=`${C}${v}`),h.value=`${h.value}.`,P(),V()}).catch(f=>{c.value=`${f}`,P(),V()})},500)},w=()=>{l.value=!0},p=()=>{location.reload()};return{logText:B(()=>l.value?o.value!==void 0&&o.value!==0?`${i}
${n.value}
${k} ${o.value}
`:`${i}
${n.value}
${y}
`:`${i}
${h.value}
${c.value}
${n.value}
`),Close:p,disabled:l,textDom:u}},mounted(){this.$nextTick(()=>{const e=document.querySelector("body");e.append?e.append(this.$el):e.appendChild(this.$el)})}},ht=e=>(rt("data-v-6695545b"),e=e(),lt(),e),Be={class:"software-log_shade"},Ve=ht(()=>s("div",{class:"software-log_shade__bg"},null,-1)),Me={class:"software-log_shade__pannel"},Fe=ht(()=>s("div",{class:"software-log_shade__pannel-title"}," \u8F6F\u4EF6\u4E2D\u5FC3 - \u65E5\u5FD7\u8BB0\u5F55 ",-1)),ze=ht(()=>s("div",{class:"software-log_shade__pannel-now"},[s("i",null,"\xA0\xA0\xA0\xA0\u63D2\u4EF6\u5B89\u88C5/\u5378\u8F7D\u8FC7\u7A0B\u4E2D\u8BF7\u52FF\u5237\u65B0\u6B64\u9875\u9762\uFF01")],-1)),Ue={class:"software-log_shade__pannel-content"},Oe=["value"],Re={key:0,class:"software-log_shade__pannel-btn"};function Ge(e,t,n,a,o,l){return d(),_("div",Be,[Ve,s("div",Me,[Fe,ze,s("div",Ue,[s("textarea",{ref:"textDom",cols:"63",rows:"26",wrap:"on",readonly:"readonly",autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false",value:a.logText},null,8,Oe)]),a.disabled?(d(),_("div",Re,[s("button",{class:"close",onClick:t[0]||(t[0]=u=>a.Close())}," \u5173\u95ED ")])):z("",!0)])])}var Ne=E(Pe,[["render",Ge],["__scopeId","data-v-6695545b"]]);const He={setup(e){const t=K();t.dispatch("getData");const n=B(()=>t.state.log.status);return(a,o)=>{const l=st("router-view");return d(),_(O,null,[N(qt),N(l),r(n)?(d(),X(Ne,{key:0})):z("",!0)],64)}}},Ke={class:"toast"},We=["title"],qe={key:1,class:"msg"},Ze=["innerHTML"],Ye={props:{content:String,type:String,Close:Function,keep:Boolean,html:Boolean},setup(e){const t=e,{$gettext:n}=R(),a=A(t.content),o=A(t.keep),l=A(t.html);t.keep||setTimeout(()=>{t.Close()},2e3);const u=()=>{t.Close()};return(i,c)=>(d(),_("div",Ke,[o.value?(d(),_("div",{key:0,class:"toast-close",onClick:u,title:r(n)("closed")},"x",8,We)):z("",!0),l.value?z("",!0):(d(),_("div",qe,g(a.value),1)),l.value?(d(),_("div",{key:2,class:"msg",innerHTML:a.value},null,8,Ze)):z("",!0)]))}};var Je=E(Ye,[["__scopeId","data-v-6a723585"]]);const F=e=>{let t={content:"",type:"",keep:!1,html:!1,Close:()=>{a.unmount(n),document.body.removeChild(n)}};e!=null&&(typeof e=="object"?(t.content=(e==null?void 0:e.content)||"",t.type=(e==null?void 0:e.type)||"",t.keep=(e==null?void 0:e.keep)||!1,t.html=(e==null?void 0:e.html)||!1):t.content=e);let n=document.createElement("div"),a=_t(Je,t);document.body.append(n),a.mount(n),wt(()=>{a.unmount(n),document.body.removeChild(n)})},Qe={props:{content:String,Close:Function},setup(e){return{message:e.content}}},Xe=e=>(rt("data-v-6d7664a4"),e=e(),lt(),e),je={class:"loading"},tn=Xe(()=>s("div",{class:"icon"},null,-1)),en={class:"msg"};function nn(e,t,n,a,o,l){return d(),_("div",je,[tn,s("div",en,g(a.message),1)])}var an=E(Qe,[["render",nn],["__scopeId","data-v-6d7664a4"]]),H={props:{content:"",Close:()=>{}},Start(e){this.props={content:e,Close:()=>{t.unmount(n),document.body.removeChild(n)}};let t=_t(an,this.props),n=document.createElement("div");document.body.append(n),t.mount(n),wt(()=>{this.props.Close()})},Stop(){this.props.Close()}};const on=()=>`
        <style>
            [lock-scroll="true"] {
                overflow: hidden !important;
            }
            .software-log_shade[data-logger],.software-log_shade[data-logger] *{-webkit-box-sizing:border-box;-webkit-tap-highlight-color:transparent;box-sizing:border-box;word-wrap:break-word;outline:none}.software-log_shade[data-logger]{width:100%;height:100%;display:flex;flex-wrap:wrap;align-items:center;justify-content:center;position:fixed;top:0;bottom:0;left:0;right:0;z-index:99999}.software-log_shade[data-logger] .software-log_shade__bg{position:fixed;top:0;bottom:0;left:0;right:0;background:rgba(68,79,83,0.94) none repeat scroll 0 0 !important;background-position:0 0;background-size:cover;opacity:0.94}.software-log_shade[data-logger] .software-log_shade__pannel{width:800px;min-width:800px;border-radius:10px;z-index:100;box-shadow:3px 3px 10px #000;background:rgba(0,0,0,0.9);padding:10px}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-title{text-align:center;font-size:18px;color:#99ff00;padding:10px;font-weight:bold}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-now i{color:#fc0;font-style:normal}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content{padding:10px;width:100%;text-align:center;overflow:hidden}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea{width:100%;border:0px solid #222;font-family:"Lucida Console";font-size:11px;background:transparent;color:#ffffff;outline:none;overflow-x:hidden;resize:none;transition:0.5s}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea:focus,.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea:hover{box-shadow:none;border-color:transparent !important}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea::-webkit-scrollbar{width:5px;height:5px}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea::-webkit-scrollbar-thumb{height:30px;outline:none;border:none;border-radius:1rem;background-color:#4c595c;-webkit-border-radius:1rem}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-content textarea::-webkit-scrollbar-track-piece{background:none;-webkit-border-radius:0;border-radius:0}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-btn{width:100%;height:50px;display:flex;flex-wrap:wrap;align-items:center;justify-content:center}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-btn button{visibility:visible;min-width:88px;font-weight:bolder;text-shadow:1px 1px 0px black;border-radius:8px;height:33px;font-family:Verdana, Microsoft Yahei UI, sans-serif;font-size:12px;padding:0 0.7em 0 0.7em;width:auto;min-width:122px;margin:0 10px;cursor:pointer;background:#090a0a !important;border:1px solid #fff !important;color:#ffffff !important;opacity:1 !important}.software-log_shade[data-logger] .software-log_shade__pannel .software-log_shade__pannel-btn button:hover{opacity:0.9 !important}
        </style>
    `,sn=()=>{const e=document.createElement("div");return e.className="software-log_shade",e.setAttribute("data-logger",""),e.innerHTML=on(),e},rn=()=>{const e=document.createElement("div");return e.className="software-log_shade__bg",e},ln=()=>{const e=document.createElement("div");return e.className="software-log_shade__pannel",e},cn=e=>{const t=document.createElement("div");return t.className="software-log_shade__pannel-title",t.textContent=e,t},un=e=>{const t=document.createElement("div");return t.className="software-log_shade__pannel-now",t.innerHTML=`<i>&nbsp;&nbsp;&nbsp;&nbsp;${e}</i>`,t},dn=()=>{const e=document.createElement("div");return e.className="software-log_shade__pannel-content",e},pn=e=>{const t=document.createElement("textarea");return t.setAttribute("readonly",""),t.setAttribute("cols","63"),t.setAttribute("rows","26"),t.setAttribute("wrap","on"),t.setAttribute("autocomplete","off"),t.setAttribute("autocapitalize","off"),t.setAttribute("spellcheck","false"),t.className="software-log_shade__pannel-content-text",t.value=e,t},_n=(e,t)=>{const n=document.createElement("button");return n.className="software-log_shade__pannel-btn-close",n.textContent=e,n.addEventListener("click",t),n},hn=()=>{const e=document.createElement("div");return e.className="software-log_shade__pannel-btn",e},gn=e=>{const t=e.title!=null?e.title:"\u65E5\u5FD7\u8BB0\u5F55",n=e.description!=null?e.description:"\u63D2\u4EF6\u5B89\u88C5/\u5378\u8F7D\u8FC7\u7A0B\u4E2D\u8BF7\u52FF\u5237\u65B0\u6B64\u9875\u9762!",a=e.clearText!=null?e.clearText:"\u5173\u95ED",o=e.value!=null?e.value:"",l=e.callback!=null?e.callback:()=>{};return{title:t,description:n,clearText:a,valueText:o,callback:l}},ut=e=>{const{title:t,description:n,clearText:a,valueText:o,callback:l}=gn(e);let u=!1,i="",c="",h=!1;const y=sn(),k=()=>{h||(document.body&&document.body.removeAttribute("lock-scroll"),l&&l(),y&&y.remove(),h=!0)},P=()=>{q.scrollTop=q.scrollHeight},V=S=>{q.value=`${i}
${S}`,P()},w=S=>{c=S,V(c)},p=S=>{w(c+S)},b=()=>{i+=".",w(c)},f=S=>{u=S,u?J.appendChild(et):J.removeChild(et)},C=()=>u,v=()=>{C()||setTimeout(()=>{T.getLog().then(S=>{switch(S==null?void 0:S.code){}const nt=S==null?void 0:S.stdout,G=S==null?void 0:S.stderr;(nt||G)&&w(`${nt}${G}`),b()}).catch(S=>{w(`${S}`)}).finally(()=>{v()})},500)};v();const $=rn(),m=ln(),x=cn(t),M=un(n),tt=dn(),q=pn(o);tt.appendChild(q);const J=hn(),et=_n(a,k);return m.append(x,M,tt,J),y.append($,m),document.body.appendChild(y),document.body.setAttribute("lock-scroll","true"),{close:k,setValue:w,addValue:p,setDisabled:f,getDisabled:C}},ct=e=>(rt("data-v-54a5b850"),e=e(),lt(),e),fn={class:"app-container"},vn={class:"app-info"},mn={class:"app-f"},wn={class:"app-icon"},bn=["alt","src"],$n={class:"app-tags"},yn={class:"tag"},kn=ct(()=>s("span",{class:"block"},"\uFF5C",-1)),xn={class:"app-r"},Cn=["title"],Sn={class:"app-name"},Ln={class:"app-version"},An={class:"app-as"},Tn=ct(()=>s("span",{style:{margin:"0 10px"}},"|",-1)),En=["title"],In=["title"],Dn=["title"],Pn={class:"app-author"},Bn={class:"app-date"},Vn={class:"app-btns"},Mn=["href"],Fn=ct(()=>s("div",{class:"auto"},null,-1)),zn=ct(()=>s("div",{class:"app-margin-left"},null,-1)),Un=["href"],On=ct(()=>s("div",{class:"app-margin-left"},null,-1)),Rn={props:{col:{type:Object,default(){return{description:"",tags:[],entry:"",author:"",depends:[],installed:!1,hasupdate:!1,title:"",time:"",release:1,website:"",name:"",version:""}}}},setup(e){const t=e,{$gettext:n}=R(),a=B(()=>t.col),o=K(),l=U.formatDate,u=U.numberToSum,i=p=>{const b=ut({title:n("updating plugin"),description:n("do not refresh this page during plugin installation/uninstallation"),clearText:n("closed"),valueText:"",callback:()=>{location.reload()}});T.upgradeApp(p).then(f=>{let C=f.stdout,v=f.stderr;b.addValue(`${C}
${v}`),b.addValue(`
${n("the update is success, please close the current window")}`)}).catch(f=>{b.addValue(`${f}`),b.addValue(`
${n("update failed with error code")}: ${500}`)}).finally(()=>{b.setDisabled(!0);try{window.L.ui.menu.flushCache()}catch(f){}})},c=p=>{const b=ut({title:n("installing plugin"),description:n("do not refresh this page during plugin installation/uninstallation"),clearText:n("closed"),valueText:"",callback:()=>{location.reload()}});T.increasingDownloadCount(p),o.dispatch("apps/incrAppDownload",{name:p}),T.installApp(p).then(f=>{let C=f.stdout,v=f.stderr;b.addValue(`${C}
${v}`),b.addValue(`
${n("installation is complete, please close the current window")}`)}).catch(f=>{b.addValue(`${f}`),b.addValue(`
${n("installation failed, error code")}: ${500}`)}).finally(()=>{b.setDisabled(!0);try{window.L.ui.menu.flushCache()}catch(f){}})},h=p=>{if(!confirm(n("are you sure you want to uninstall %{name}?",{name:p})))return;const f=ut({title:n("uninstalling plugin"),description:n("do not refresh this page during plugin installation/uninstallation"),clearText:n("closed"),valueText:"",callback:()=>{location.reload()}});T.removeApp(p).then(C=>{let v=C.stdout,$=C.stderr;f.addValue(`${v}
${$}`),f.addValue(`
${n("uninstallation succeeded, please close the current window")}`)}).catch(C=>{f.addValue(`${C}`),f.addValue(`
${n("uninstall failed, error code")}: ${500}`)}).finally(()=>{f.setDisabled(!0);try{window.L.ui.menu.flushCache()}catch(C){}})},y=p=>L(this,null,function*(){H.Start();try{(yield T.postStarApp(p))&&o.dispatch("apps/incrAppStar",{name:p})}catch(b){}H.Stop()}),k=()=>{F(n("you have already liked"))},P=p=>a.value.installed?`/luci-static/resources/app-icons/${p}.png`:a.value.icon?T.getStoreAppIcon(a.value.icon):`/luci-static/resources/app-icons/${p}.png`,V=p=>{switch(window.vue_lang){case"zh-cn":case"zh-tw":return p.title}return p.title_en||p.title},w=p=>{switch(window.vue_lang){case"zh-cn":case"zh-tw":return p.description}return p.description_en||p.description};return(p,b)=>{var v,$,m,x,M,tt,q,J,et,S,nt;const f=st("svg-star-off"),C=st("svg-star-on");return d(),_("div",fn,[s("div",vn,[s("div",mn,[s("div",wn,[s("img",{alt:r(n)("Icon is gone")+"~",src:P(r(a).name)},null,8,bn)]),s("div",$n,[(d(!0),_(O,null,W(r(a).tags,G=>(d(),_(O,{key:G},[s("div",yn,[s("span",null,g(r(kt)(G)),1)]),kn],64))),128))])]),s("div",xn,[s("div",{class:"app-title",title:r(a).name},[s("span",Sn,g(V(r(a))),1),s("span",Ln,"v"+g(r(a).version),1)],8,Cn),s("div",An,[s("span",null,g(r(n)("%{name} downloads",{name:r(u)(($=(v=r(a))==null?void 0:v.expand)==null?void 0:$.downloadCount)})),1),Tn,s("span",null,g(r(n)("%{name} links",{name:r(u)((x=(m=r(a))==null?void 0:m.expand)==null?void 0:x.starCount)})),1),((M=r(a))==null?void 0:M.expand)!=null?(d(),_(O,{key:0},[(q=(tt=r(a))==null?void 0:tt.expand)!=null&&q.isStar?(d(),_("a",{key:0,class:"star-btn",title:r(n)("liked"),onClick:b[0]||(b[0]=G=>k())},[N(f)],8,En)):(d(),_("a",{key:1,class:"star-btn",title:r(n)("like"),onClick:b[1]||(b[1]=G=>y(r(a).name))},[N(C)],8,In))],64)):z("",!0)]),s("div",{class:"app-description cbi-value-description",title:w(r(a))},[s("span",null,g(w(r(a))),1)],8,Dn),s("div",Pn,[s("span",null,g(r(n)("author"))+": "+g(r(a).author||"null"),1)]),s("div",Bn,[s("span",null,g(r(n)("update date"))+": "+g(r(l)(r(a).time*1e3)||"null"),1)])])]),s("div",Vn,[r(a).website?(d(),_("a",{key:0,class:"app-btn cbi-button cbi-button-apply",target:"_blank",href:r(a).website},g(r(n)("website")),9,Mn)):z("",!0),Fn,r(a).installed?(d(),_(O,{key:1},[((J=r(a))==null?void 0:J.curVersion)!=((et=r(a))==null?void 0:et.lastVersion)||((S=r(a))==null?void 0:S.curRelease)!=((nt=r(a))==null?void 0:nt.lastRelease)?(d(),_("a",{key:0,class:"app-btn cbi-button cbi-button-reload",onClick:b[2]||(b[2]=G=>i(r(a).name))},g(r(n)("upgrade")),1)):z("",!0),zn,r(a).entry?(d(),_("a",{key:1,class:"app-btn cbi-button cbi-button-apply",href:r(a).entry},g(r(n)("open")),9,Un)):z("",!0),On,s("a",{class:"app-btn cbi-button cbi-button-remove",onClick:b[3]||(b[3]=G=>h(r(a).name))},g(r(n)("uninstall")),1)],64)):(d(),_("a",{key:2,class:"app-btn cbi-button cbi-button-add",onClick:b[4]||(b[4]=G=>c(r(a).name))},g(r(n)("install")),1))])])}}};var xt=E(Rn,[["__scopeId","data-v-54a5b850"]]);const Gn={class:"cbi-section"},Nn={class:"containers"},Hn={setup(e){const t=K(),n=B(()=>t.getters["apps/LocalApps"]);return(a,o)=>(d(),_("fieldset",Gn,[s("div",Nn,[(d(!0),_(O,null,W(r(n),l=>(d(),X(xt,{key:l.name,col:l},null,8,["col"]))),128))])]))}};var Kn=E(Hn,[["__scopeId","data-v-0046e0f2"]]);const Wn={class:"sort-container"},qn={class:"sort-title"},Zn={class:"sort-value"},Yn=["value","onClick"],Jn={setup(e){const{$gettext:t}=R(),n=A("default"),a=K(),o=A([{key:t("default"),value:"default"},{key:t("By download"),value:"download"},{key:t("By rating"),value:"star"}]),l=u=>{n.value=u,a.dispatch("apps/filterCurApps",{sort:u})};return(u,i)=>(d(),_("div",Wn,[s("div",qn,g(r(t)("order"))+":",1),s("div",Zn,[(d(!0),_(O,null,W(o.value,c=>(d(),_("input",{key:c.value,class:j(["cbi-button",{"cbi-button-apply":n.value==c.value}]),type:"button",value:c.key,onClick:h=>l(c.value)},null,10,Yn))),128))])]))}};var Qn=E(Jn,[["__scopeId","data-v-e3845a5c"]]);const Xn={class:"tags-container"},jn={class:"tags-title"},ta={class:"tags-value"},ea=["value"],na=["value","onClick"],aa={setup(e){const{$gettext:t}=R(),n=A("default"),a=K(),o=B(()=>a.getters["tags/Tags"]),l=u=>{n.value=u,a.dispatch("apps/filterCurApps",{tag:u})};return(u,i)=>(d(),_("div",Xn,[s("div",jn,g(r(t)("tag"))+": ",1),s("div",ta,[s("input",{class:j(["cbi-button",{"cbi-button-apply":n.value=="default"}]),type:"button",value:r(t)("default"),onClick:i[0]||(i[0]=c=>l("default"))},null,10,ea),(d(!0),_(O,null,W(r(o),c=>(d(),_("input",{key:c,class:j(["cbi-button",{"cbi-button-apply":n.value==c}]),type:"button",value:r(kt)(c),onClick:h=>l(c)},null,10,na))),128))])]))}};var oa=E(aa,[["__scopeId","data-v-07bccc36"]]);const sa=["onSubmit"],ra=["placeholder"],la={setup(e){const{$gettext:t}=R(),n=A(""),a=K(),o=()=>{a.dispatch("apps/filterCurApps",{search:n.value})};return(l,u)=>{const i=st("svg-search");return d(),_("form",{class:"search",onSubmit:$t(o,["prevent"])},[s("a",{class:"search-btn",onClick:o},[N(i)]),it(s("input",{type:"text",placeholder:r(t)("please enter the search keyword"),"onUpdate:modelValue":u[0]||(u[0]=c=>n.value=c)},null,8,ra),[[bt,n.value,void 0,{trim:!0}]])],40,sa)}}};var ca=E(la,[["__scopeId","data-v-c4e8a9f2"]]);const ia={class:"containers"},ua={key:1,style:{margin:"10px 0","text-align":"center",width:"100%"}},da={setup(e){const{$gettext:t}=R(),n=K(),a=B(()=>n.getters["apps/StoreApps"]),o=B(()=>n.state.apps.Load);return(l,u)=>(d(),_("div",ia,[r(o)?(d(!0),_(O,{key:0},W(r(a),i=>(d(),X(xt,{key:i.name,col:i},null,8,["col"]))),128)):(d(),_("span",ua,g(r(t)("loading data"))+"...",1))]))}};var pa=E(da,[["__scopeId","data-v-1b494368"]]);const _a={class:"cbi-section"},ha={setup(e){return(t,n)=>(d(),_("fieldset",_a,[N(ca),N(oa),N(Qn),N(pa)]))}};var ga=E(ha,[["__scopeId","data-v-74b0669f"]]);const fa=e=>(rt("data-v-9c880c04"),e=e(),lt(),e),va={class:"cbi-section"},ma={class:"container_msg cbi-map-descr"},wa=["onSubmit"],ba={class:"upload-file"},$a={class:"button"},ya=fa(()=>s("div",{class:"auto"},null,-1)),ka={setup(e){const{$gettext:t}=R(),n=A(null),a=A(null);mt(()=>{if(n.value){const i=n.value;i.addEventListener("dragenter",c=>{(c.fromElement===null||!i.contains(c.fromElement))&&console.log("dragenter")},!1),i.addEventListener("dragleave",c=>{(c.fromElement===null||!i.contains(c.fromElement))&&console.log("dragleave")},!1),i.addEventListener("dragover",c=>{c.preventDefault(),c.dataTransfer.dropEffect="link"},!1),i.addEventListener("drop",c=>{console.log("drop"),c.preventDefault(),o(c)},!1)}});const o=i=>{const c=i.dataTransfer.files;if(c&&c.length>0){const h=c[0];u(h);return}},l=i=>{const c=i.target.files;if(c&&c.length>0){const h=c[0];u(h);return}},u=i=>{if(i.name.endsWith(".run")||i.name.endsWith(".ipk")){const c=ut({title:t("uploading plugin"),description:t("do not refresh this page during plugin installation/uninstallation"),clearText:t("closed"),valueText:"",callback:()=>{location.reload()}});let h=new FormData;h.append(i.name,i),T.uploadAppIPK(h).then(y=>{let k=y.stdout,P=y.stderr;c.addValue(`${k}
${P}`),c.addValue(`
${t("offline installation is successful, please close the current window")}`)}).catch(y=>{c.addValue(`${y}`),c.addValue(`
${t("offline installation failed with error code")}: ${500}`)}).finally(()=>{c.setDisabled(!0);try{window.L.ui.menu.flushCache()}catch(y){}})}};return(i,c)=>{var h;return d(),_("fieldset",va,[s("div",ma,[s("span",null,g(r(t)("offline install")),1),s("span",null,"\xB7 "+g(r(t)("from this page, you can upload plugin packages to install plugins")),1),s("span",null,"\xB7 "+g(r(t)("support .ipk plug-in, .run self-extracting format")),1)]),s("form",{onSubmit:$t(u,["prevent"])},[s("div",{class:"flex",ref_key:"upl",ref:n},[s("label",ba,[s("span",null,g(((h=a.value)==null?void 0:h.name)||r(t)("no files selected")),1),s("input",{type:"file",name:"file",accept:".ipk, .run",hidden:"",onChange:l},null,32),s("div",$a,g(r(t)("select or drag and drop files")),1)]),ya],512)],40,wa)])}}};var xa=E(ka,[["__scopeId","data-v-9c880c04"]]);const Ca={class:"cbi-section"},Sa={class:"webapp-container"},La=["src"],Aa={setup(e){const t=B(()=>""),n=B(()=>""),a=B(()=>`${U.getIframeURL()}/#/apps?token=${n.value}&deviceId=${t.value}`);return(o,l)=>(d(),_("fieldset",Ca,[s("div",Sa,[s("iframe",{src:r(a),sandbox:"allow-scripts allow-same-origin allow-popups",seamless:""},null,8,La)])]))}};var Ta=E(Aa,[["__scopeId","data-v-8e330954"]]);const Ea={class:"log-containers"},Ia={key:0,class:"containers-tit"},Da={key:1,class:"containers-tit"},Pa=["value"],Ba={key:1},Va={setup(e){const{$gettext:t}=R(),n=K(),a=B(()=>n.state.version),o=B(()=>n.state.versionLoad),l=()=>{H.Start(`${t("updateing")}...`),T.selfUpdateIstore().then(({data:u})=>{if(u){const{stdout:i,stderr:c,code:h}=u;if(h==0){F(t("update success")),n.dispatch("istoreUpdated");return}else throw c||"unknown error"}throw"unknown error"}).catch(u=>{F(`${t("update error")}: ${u}`)}).finally(()=>{H.Stop()})};return(u,i)=>(d(),_("div",Ea,[r(o)?(d(),_("div",Da,[r(a)?(d(),_(O,{key:0},[s("span",null,g(r(t)("last version"))+":"+g(r(a)),1),s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:i[0]||(i[0]=c=>l()),value:r(t)("click to update")},null,8,Pa)],64)):(d(),_("span",Ba,g(r(t)("the is last version"))+"...",1))])):(d(),_("div",Ia,g(r(t)("checking for latest version")),1))]))}};var Ma=E(Va,[["__scopeId","data-v-8f2ad39a"]]),Fa={namespaced:!0,state:{Load:!1,LocalApps:[],StoreApps:[],Expand:{},Cur:{tag:"default",sort:"default",search:"",limit:30,offset:0},LocalAppsMap:{},StoreAppsMap:{}},mutations:{setExpand(e,t){e.Expand=t},setLocalApps(e,t){e.LocalApps=t||[],t.forEach(n=>{e.LocalAppsMap[n.name]=n})},setStoreApps(e,t){e.StoreApps=t||[],t.forEach(n=>{e.StoreAppsMap[n.name]=n})},setCur(e,t){for(const n in t)Object.hasOwnProperty.call(t,n)&&(e.Cur[n]=t[n])}},getters:{Cur(e){return e.Cur},LocalApps(e){let t=[...e.LocalApps],n=e.Expand;for(let a=0;a<t.length;a++){let o=t[a].name;n[o]&&(t[a].expand=n[o]),e.StoreAppsMap[o]&&(t[a].curVersion=t[a].version,t[a].curRelease=t[a].release,t[a].lastVersion=e.StoreAppsMap[o].version,t[a].lastRelease=e.StoreAppsMap[o].release)}return t},StoreApps(e){var u,i,c,h,y,k,P,V;let t=[...e.StoreApps],n=e.Expand;for(let w=0;w<t.length;w++){let p=t[w].name;n[p]&&(t[w].expand=n[p]),e.LocalAppsMap[p]&&(t[w].installed=!0,t[w].lastVersion=t[w].version,t[w].lastRelease=t[w].release,t[w].curVersion=e.LocalAppsMap[p].version,t[w].curRelease=e.LocalAppsMap[p].release)}let a=e.Cur.tag;if(a!="default"){let w=[];t.forEach(p=>{p.tags&&p.tags.forEach(b=>{b==a&&w.push(p)})}),t=w}let o=e.Cur.search;if(o){let w=[];t.forEach(p=>{let b=JSON.stringify(p);new RegExp(o,"i").test(b)&&w.push(p)}),t=w}let l=t.length;switch(e.Cur.sort){case"download":for(let w=0;w<l-1;w++)for(let p=0;p<l-1-w;p++){let b=((i=(u=t[p])==null?void 0:u.expand)==null?void 0:i.downloadCount)||0,f=((h=(c=t[p+1])==null?void 0:c.expand)==null?void 0:h.downloadCount)||0;if(b<f){let C=t[p];t[p]=t[p+1],t[p+1]=C}}break;case"star":for(let w=0;w<l-1;w++)for(let p=0;p<l-1-w;p++){let b=((k=(y=t[p])==null?void 0:y.expand)==null?void 0:k.starCount)||0,f=((V=(P=t[p+1])==null?void 0:P.expand)==null?void 0:V.starCount)||0;if(b<f){let C=t[p];t[p]=t[p+1],t[p+1]=C}}break}return t}},actions:{incrAppDownload(e,t){const{state:n}=e;n.Expand[t==null?void 0:t.name]&&n.Expand[t==null?void 0:t.name].downloadCount++},incrAppStar(e,t){const{state:n}=e;n!=null&&n.Expand[t==null?void 0:t.name]&&(n.Expand[t==null?void 0:t.name].starCount++,n.Expand[t==null?void 0:t.name].isStar=!0)},filterCurApps(e,t){const{commit:n,dispatch:a}=e;n("setCur",t)},getApps(e){const{state:t,dispatch:n}=e;n("getLocalApps"),n("getStoreApps",t.Cur)},getLocalApps(e){const{commit:t}=e;T.getInstalledApp().then(n=>{n.forEach(a=>{a.installed=!0}),t("setLocalApps",n)})},getStoreApps(e,t){const{state:n,commit:a,dispatch:o}=e;let l=[];T.getStoreAppList(t).then(u=>{u.apps&&(u.apps.forEach(i=>{l.push(i.name)}),o("getStoreAppsExpand",l),a("setStoreApps",u.apps)),n.Load=!0}).catch(u=>{console.log(u)})},getStoreAppsExpand(e,t){const{commit:n}=e;T.getAppExpandData(t).then(a=>{a&&n("setExpand",a)})}}},za={namespaced:!0,state:{Tags:[],Total:0},mutations:{},getters:{Tags(e){return e.Tags},Total(e){return e.Total}},actions:{getTags(e){const{state:t,commit:n}=e;T.getStoreTags().then(a=>{t.Tags=(a==null?void 0:a.tags)||[],t.Total=(a==null?void 0:a.total)||0})}}},Ua={namespaced:!0,state:{status:!1,action:"install",content:"",end:!1,exitCode:void 0},mutations:{setStatus(e,t){e.status=t.status,e.action=(t==null?void 0:t.action)||"install",e.content=(t==null?void 0:t.content)||"",e.end=(t==null?void 0:t.end)||!1,e.exitCode=void 0},setContent(e,t){e.content=t},setEnd(e,t){e.end=!0,e.exitCode=t}},getters:{},actions:{}},ot=Vt({state:{version:"",versionLoad:!1},mutations:{setVersion(e,t){e.version=t},setVersionLoad(e,t){e.versionLoad=t}},modules:{apps:Fa,tags:za,log:Ua},actions:{getData(e){const{dispatch:t}=e;t("tags/getTags"),t("apps/getApps"),t("getVersion")},getVersion(e){return L(this,null,function*(){const{commit:t}=e;try{const n=yield T.updateIstore(),{code:a,msg:o}=n==null?void 0:n.data;a==200&&t("setVersion",o)}catch(n){console.log(n)}t("setVersionLoad",!0)})},istoreUpdated(e){const{commit:t}=e;t("setVersion","")}}}),at={Start(e,t){ot.commit("log/setStatus",{status:!0,action:e,content:""})},Stop(){ot.commit("log/setStatus",{status:!1,action:"install",content:""})},Add(e){ot.commit("log/setContent",e)},End(e){ot.commit("log/setEnd",e)}};const Oa={class:"Lightweight"},Ra={class:"Lightweight-container"},Ga={class:"model"},Na={class:"Lightweight-container1"},Ha={class:"container1-center"},Ka={class:"Lightweight-tit"},Wa={class:"Lightweight-backup"},qa=["value"],Za=["value"],Ya={setup(e){const{$gettext:t}=R(),n=A(null),a=()=>{const i=t("backuping"),c=t("backup success"),h=t("backup fail"),y=t("click to download");H.Start(`${i}...`),T.lightBackup().then(k=>{if(k){const{msg:P,code:V}=k;if(V==200){F({content:`${c}\uFF0C<a href="/cgi-bin/luci/admin/store/get_light_backup_file" target="_blank">${y}</a><br/><br/>`,keep:!0,html:!0});return}else throw P||"unknown error"}throw"unknown error"}).catch(k=>{F(`${h} : ${k}`)}).finally(()=>{H.Stop()})},o=i=>{const c=i.target.files;if(c&&c.length>0){const h=c[0];l(h);return}},l=i=>{let c=new FormData;c.append(i.name,i),at.Start("upload"),T.lightRestore(c).then(h=>{let y=h.stdout,k=h.stderr;at.Add(`${y}
${k}`),at.End(h.code)}).catch(h=>{at.Add(h),at.End(500)})},u=i=>{n.value.click(i),i.preventDefault()};return(i,c)=>(d(),_("div",Oa,[s("div",Ra,[s("div",Ga,g(r(t)("explain")),1),s("div",Na,[s("div",Ha,[s("div",Ka,[s("span",null,"\xB7 "+g(r(t)("backup now will download a list of iStore installed software")),1),s("span",null,"\xB7 "+g(r(t)("upload software list and install from iStore when restoring backup")),1)]),s("div",Wa,[s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:a,value:r(t)("backup now")},null,8,qa),s("input",{type:"file",name:"file",accept:".tar, .gz",hidden:"",onChange:o,ref_key:"upl",ref:n},null,544),s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:u,value:r(t)("restore backup")},null,8,Za)])])])])]))}};var Ja=E(Ya,[["__scopeId","data-v-0f5d170b"]]);const Qa={class:"local"},Xa={class:"local-container"},ja={class:"model"},to={class:"local-container1"},eo={class:"container1-center"},no={class:"local-tit"},ao={class:"local-device"},oo={class:"local-input"},so={value:"",disabled:""},ro=["value"],lo={value:"-"},co=["onKeyup","placeholder"],io={key:2,class:"local-btn"},uo=["value"],po=["value"],_o={key:0,class:"device-list"},ho=["value"],go=["value"],fo={setup(e){const{$gettext:t}=R(),n=t("backup now backs up installed software (unlimited installation sources) to external storage"),a=A([]),o=A("-");let l="-";const u=A(!1),i=A([]),c=A(""),h=A(""),y=A(),k=(v,$)=>{if(!($===""||$==="-"||v.find(m=>m.path===$))){let m;v.filter(x=>x.mount&&x.dev&&$.startsWith(x.mount)).forEach(x=>{m&&m.mount.length>x.mount.length||(m=x)}),v.push({path:$,size:m?m.size:void 0})}a.value=v,$!=="-"&&(o.value=$,P())};o.value=="-"&&(T.localBackupdirPath().then(v=>{if(v){const{code:$,msg:m}=v;$==200&&k(a.value,m)}}),T.getBlockDevices().then(v=>{if(v&&v.code==200){const $=v.data,m=[];for(let x in $){const M=$[x];M.mount&&M.mount!="/"&&M.mount!="/rom"&&M.mount!="/overlay"&&m.push(M)}m.forEach(x=>{x.path=x.mount+"/istore_backup"}),k(m,m.length>0&&o.value==="-"?"":o.value)}}));const P=v=>{u.value=!1,o.value==="-"?(l!="-"&&(h.value=l),y.value.focus()):l=o.value},V=v=>{h.value==""?l!="-"?o.value=l:o.value="":h.value.startsWith("/")?k(a.value,h.value):(F(t("please enter the path, give up the input, please clear the input box")),y.value.setSelectionRange(0,h.value.length),y.value.focus())},w=()=>o.value.length>1&&o.value.endsWith("/")?o.value.substring(0,o.value.length-1):o.value,p=()=>{let v=w();if(v==""){F(t("please fill in the external storage directory"));return}u.value=!1,T.backupFileList(v).then($=>{if($){const{code:m,msg:x}=$;if(m==200){let M=JSON.parse(x);M.length==0?(F(t("there are no backup files in this path")),u.value=!1):(i.value=M,u.value=!0);return}throw x||"unknown error"}throw"unknown error"}).catch($=>{F($)})},b=()=>{let v=w();if(v==""){F(t("please fill in the external storage directory"));return}H.Start(`${t("backuping")}...`),T.localBackup(v).then($=>{if($){const{msg:m,code:x,stderr:M}=$;if(x==0){F(t("backup success"));return}else throw x==500?m:M||"unknown error"}throw"unknown error"}).catch($=>{F(`${t("backup fail")}: ${$}`)}).finally(()=>{H.Stop()})},f=v=>o.value.endsWith("/")?o.value+v:o.value+"/"+v,C=()=>{if(c.value===""){F(t("please select a backup file to restore"));return}H.Start(`${t("restoring backup")}...`),T.localRestore(f(c.value)).then(v=>{if(v){const{msg:$,stderr:m,code:x}=v;if(x==0){F(t("the backup was restored success"));return}else throw $||m||"unknown error"}throw"unknown error"}).catch(v=>{F(`${t("the backup was restored fail")}: ${v}`)}).finally(()=>{H.Stop()})};return(v,$)=>(d(),_("div",Qa,[s("div",Xa,[s("div",ja,g(r(t)("explain")),1),s("div",to,[s("div",eo,[s("div",no,[s("span",null,"\xB7 "+g(r(t)(r(n))),1),s("span",null,"\xB7 "+g(r(t)("no internet required for recovery")),1)]),s("div",ao,g(r(t)("external storage directory"))+" \uFF1A ",1),s("div",oo,[o.value!="-"?it((d(),_("select",{key:0,class:"local-input-field",onChange:P,"onUpdate:modelValue":$[0]||($[0]=m=>o.value=m)},[s("option",so,g(r(t)("choose")),1),(d(!0),_(O,null,W(a.value,(m,x)=>(d(),_("option",{value:m.path,key:x},g(m.path+(m.size?"\uFF08"+m.size+"\uFF09":"")),9,ro))),128)),s("option",lo,g(r(t)("customize")),1)],544)),[[vt,o.value,void 0,{trim:!0}]]):it((d(),_("input",{key:1,class:"local-input-field",onBlur:V,onKeyup:Mt(V,["enter"]),placeholder:r(t)("please enter an absolute path starting with %{name}",{name:"/"}),type:"text","onUpdate:modelValue":$[1]||($[1]=m=>h.value=m),ref_key:"user_input",ref:y},null,40,co)),[[bt,h.value,void 0,{trim:!0}]]),o.value!="-"&&o.value!=""?(d(),_("div",io,[s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:b,value:r(t)("backup now")},null,8,uo),s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:p,value:r(t)("restore backup")},null,8,po)])):z("",!0)]),u.value?(d(),_("div",_o,[s("div",null,g(r(t)("choose backup file"))+" \uFF1A",1),it(s("select",{"onUpdate:modelValue":$[2]||($[2]=m=>c.value=m)},[(d(!0),_(O,null,W(i.value,m=>(d(),_("option",{key:m,value:m},g(m),9,ho))),128))],512),[[vt,c.value,void 0,{trim:!0}]]),s("input",{type:"button",class:"app-btn cbi-button cbi-button-apply",onClick:C,value:r(t)("restore now")},null,8,go)])):z("",!0)])])])]))}};var vo=E(fo,[["__scopeId","data-v-745c433e"]]);const mo={class:"cbi-map"},wo={class:"cbi-section"},bo={class:"panel-title"},$o={class:"cbi-section"},yo={class:"panel-title"},ko={class:"cbi-tabmenu"},xo={onclick:"false",href:"#"},Co={onclick:"false",href:"#"},So={setup(e){const{$gettext:t}=R(),n=A(2);return(a,o)=>(d(),_("div",mo,[s("fieldset",wo,[s("span",bo,g(r(t)("upgrade"))+" iStore",1),N(Ma)]),s("fieldset",$o,[s("span",yo,g(r(t)("app backup")),1),s("ul",ko,[s("li",{class:j(n.value==2?"cbi-tab":"cbi-tab-disabled"),onClick:o[0]||(o[0]=l=>n.value=2)},[s("a",xo,g(r(t)("light backup")),1)],2),s("li",{class:j(n.value==3?"cbi-tab":"cbi-tab-disabled"),onClick:o[1]||(o[1]=l=>n.value=3)},[s("a",Co,g(r(t)("local backup")),1)],2)]),n.value==2?(d(),X(Ja,{key:0})):z("",!0),n.value==3?(d(),X(vo,{key:1})):z("",!0)])]))}};var Lo=E(So,[["__scopeId","data-v-1d5c62fe"]]);const Ao=Ft({history:zt(U.BasePage()),routes:[{path:"/",redirect:"/installed"},{path:"/installed",name:"Installed",component:Kn},{path:"/store",name:"Store",component:ga},{path:"/upload",name:"Upload",component:xa},{path:"/webapps",name:"Webapps",component:Ta},{path:"/maintance",name:"Maintance",component:Lo},{path:"/:pathMatch(.*)*",name:"notfound",redirect:"/"}]}),To={},Eo={width:"16px",height:"16px",viewBox:"0 0 16 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},Io=s("path",{d:"M14.9234958,14.5525054 L10.84453,10.4679606 C11.8849284,9.46327833 12.5294813,8.07823887 12.5294813,6.55073066 C12.5294813,3.48989918 9.94358337,1 6.76474066,1 C3.58589795,1 1,3.48989918 1,6.55073066 C1,9.61156213 3.58589795,12.1014613 6.76474066,12.1014613 C8.16008242,12.1014613 9.44067838,11.621191 10.438802,10.8242646 L14.5276502,14.9188536 C14.5814545,14.9730393 14.6533765,15 14.725573,15 C14.7942009,15 14.8625542,14.9754182 14.9158095,14.9262546 C15.025065,14.8250198 15.0283592,14.6577049 14.9234958,14.5525054 Z M6.76474066,11.5728203 C3.8886841,11.5728203 1.54902292,9.32001661 1.54902292,6.55073066 C1.54902292,3.7814447 3.8886841,1.52864101 6.76474066,1.52864101 C9.64079723,1.52864101 11.9804584,3.7814447 11.9804584,6.55073066 C11.9804584,9.32001661 9.64052272,11.5728203 6.76474066,11.5728203 Z",id:"Shape",stroke:"#FFFFFF","stroke-width":"1.3"},null,-1),Do=[Io];function Po(e,t,n,a,o,l){return d(),_("svg",Eo,Do)}var Bo=E(To,[["render",Po]]);const Vo={},Mo={width:"12px",height:"12px",viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},Fo=s("path",{d:"M10.171916,3.81818329 C10.6519813,3.81274681 11.1102149,4.01840688 11.4252438,4.38069009 C11.7402726,4.74297329 11.8803105,5.2253253 11.8081406,5.70080197 L11.0555552,10.608963 C10.9332063,11.4157454 10.2351606,12.0090843 9.42537185,12 L3.27269856,12 C2.97145497,12 2.7272488,11.7556885 2.7272488,11.454445 L2.7272488,5.4544976 C2.7272488,5.37817917 2.74326442,5.30271013 2.77426027,5.23296947 L4.95605931,0.323921631 C5.04360472,0.126944443 5.23894201,0 5.4544976,0 C6.65947193,0 7.63629663,0.976824702 7.63629663,2.18179904 L7.63629663,3.81815451 L10.171916,3.81818329 Z M3.81814832,10.9090654 L9.43153778,10.9090654 C9.70352269,10.9121048 9.93620458,10.7143252 9.97712277,10.4445109 L10.7297188,5.53628009 C10.7537339,5.3780602 10.7070546,5.2172762 10.602045,5.09651513 C10.4970353,4.97575406 10.3442908,4.9072007 10.1780925,4.90904784 L7.09084687,4.90904784 C6.78960329,4.90904784 6.54539711,4.66484166 6.54539711,4.36359808 L6.54539711,2.18179904 C6.54539711,1.69494967 6.22647822,1.2825878 5.78615711,1.14223013 L3.81814832,5.57024992 L3.81814832,10.9090654 Z M2.7272488,5.99994736 L1.63634928,5.99994736 C1.33510569,5.99994736 1.09089952,6.24415353 1.09089952,6.54539711 L1.09089952,10.3635454 C1.09089952,10.664789 1.33510569,10.9089952 1.63634928,10.9089952 L2.7272488,10.9089952 L2.7272488,5.99994736 Z M3.27269856,11.9998947 L1.63634928,11.9998947 C0.732618527,11.9998947 -1.03028697e-13,11.2672762 -1.03028697e-13,10.3635454 L-1.03028697e-13,6.54539711 C-1.03028697e-13,5.64166636 0.732618527,4.90904784 1.63634928,4.90904784 L3.27269856,4.90904784 C3.57394214,4.90904784 3.81814832,5.15325401 3.81814832,5.4544976 L3.81814832,11.454445 C3.81814832,11.7556885 3.57394214,11.9998947 3.27269856,11.9998947 Z",id:"Shape",fill:"#FFFFFF","fill-rule":"nonzero"},null,-1),zo=[Fo];function Uo(e,t,n,a,o,l){return d(),_("svg",Mo,zo)}var Oo=E(Vo,[["render",Uo]]);const Ro={},Go={width:"12px",height:"12px",viewBox:"0 0 12 12",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},No=s("path",{d:"M10.171916,3.81818329 C10.6519813,3.81274681 11.1102149,4.01840688 11.4252438,4.38069009 C11.7402726,4.74297329 11.8803105,5.2253253 11.8081406,5.70080197 L11.0555552,10.608963 C10.9332063,11.4157454 10.2351606,12.0090843 9.42537185,12 L3.27269856,12 C2.97145497,12 2.7272488,11.7556885 2.7272488,11.454445 L2.7272488,5.4544976 C2.7272488,5.37817917 2.74326442,5.30271013 2.77426027,5.23296947 L4.95605931,0.323921631 C5.04360472,0.126944443 5.23894201,0 5.4544976,0 C6.65947193,0 7.63629663,0.976824702 7.63629663,2.18179904 L7.63629663,3.81815451 L10.171916,3.81818329 Z M3.27269856,11.9998947 L1.63634928,11.9998947 C0.732618527,11.9998947 0,11.2672762 0,10.3635454 L0,6.54539711 C0,5.64166636 0.732618527,4.90904784 1.63634928,4.90904784 L3.27269856,4.90904784 C3.57394214,4.90904784 3.81814832,5.15325401 3.81814832,5.4544976 L3.81814832,11.454445 C3.81814832,11.7556885 3.57394214,11.9998947 3.27269856,11.9998947 Z",id:"Shape",fill:"#FFE45A","fill-rule":"nonzero"},null,-1),Ho=[No];function Ko(e,t,n,a,o,l){return d(),_("svg",Go,Ho)}var Wo=E(Ro,[["render",Ko]]);const Q=_t(He);Q.component("svg-search",Bo);Q.component("svg-star-on",Oo);Q.component("svg-star-off",Wo);const qo=()=>L(I,null,function*(){yield Ot(Q),Q.use(Ao).use(ot),Q.mount("#app")});qo()});export default Zo();
